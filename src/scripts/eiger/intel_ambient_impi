#!/bin/bash -l
STATE="void"
STATE_AMBIENT="void"
STATE_DMRG="void"
# end of target states #
SHARED_FS=true
PREFIX=ambient
COMPILER=iccxe
COMPILER_VERSION=2011
MPI_WRAPPER=impi
MPI_WRAPPER_VERSION=4.0
BOOST=boost
BOOST_VERSION=1.46.1
CMAKE=cmake

export CXX=icpc
export CC=icc
export BOOST_ROOT=/apps/eiger/boost_1_46_1
export MKLROOT=/apps/eiger/Intel-Composer-XE-2011/mkl

module load ${COMPILER}/${COMPILER_VERSION}
module load ${MPI_WRAPPER}/${MPI_WRAPPER_VERSION}
module load ${BOOST}/${BOOST_VERSION}
module load ${CMAKE}

## common ##
#COMMON_CMAKE_CXX_FLAGS="-O0 -g -DNDEBUG"
#COMMON_CMAKE_CXX_FLAGS_RELEASE="-O0 -g -DNDEBUG"
#COMMON_CMAKE_CXX_FLAGS="-O2 -DNDEBUG" # -inline-level=2"
#COMMON_CMAKE_CXX_FLAGS_RELEASE="-O2 -DNDEBUG" # -inline-level=2"
COMMON_CMAKE_C_COMPILER=icc
COMMON_CMAKE_CXX_COMPILER=icpc
COMMON_MPI_CXX_FOUND=TRUE
COMMON_MPI_CXX_INCLUDE_PATH=/apps/eiger/Intel-MPI-4.0/intel64/include
COMMON_MPI_CXX_LINK_FLAGS=""
COMMON_MPI_CXX_LIBRARIES="-L/apps/eiger/Intel-MPI-4.0/lib64 -lmpi_mt"
COMMON_MPIEXEC=/apps/eiger/Intel-MPI-4.0/intel64/bin/mpirun
COMMON_MPIEXEC_NUMPROC_FLAG="-np"
COMMON_MPIEXEC_MAX_NUMPROCS="1"
COMMON_MPIEXEC_POSTFLAGS=""

COMMON_AMBIENT_THREADING="cilk"
COMMON_BLAS_LAPACK_SELECTOR="mkl_sequential"
COMMON_PLASMA_LIB_DIR="TODO"

## ambient ##
AMBIENT_ENABLE_REGRESSION_FUNCTIONAL=ON
AMBIENT_ENABLE_REGRESSION_PERFORMANCE=ON
AMBIENT_BOOST_BINDINGS_INCLUDE=/project/h07/ALPS_INTEL12_O0/include
AMBIENT_SCALAPACK_LIBRARY="-lmkl_scalapack_lp64 -lmkl_blacs_intelmpi_lp64"
## dmrg ##
DMRG_CMAKE_CXX_FLAGS="-w"
DMRG_ALPS_ROOT_DIR=/project/h07/ALPS_INTEL12_O0
DMRG_BUILD_REGRESSION=OFF
DMRG_BUILD_AMBIENT=ON
DMRG_USE_AMBIENT=ON

source $ROOT_DIR/scripts/common/common.sh 
execute $*
