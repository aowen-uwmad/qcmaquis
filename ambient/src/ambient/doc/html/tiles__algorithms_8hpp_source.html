<!-- This comment will put IE 6, 7 and 8 in quirks mode -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>numeric/matrix/tiles_algorithms.hpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javaScript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.6.1 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <img id="MSearchSelect" src="search/search.png"
             onmouseover="return searchBox.OnSearchSelectShow()"
             onmouseout="return searchBox.OnSearchSelectHide()"
             alt=""/>
        <input type="text" id="MSearchField" value="Search" accesskey="S"
             onfocus="searchBox.OnSearchFieldFocus(true)" 
             onblur="searchBox.OnSearchFieldFocus(false)" 
             onkeyup="searchBox.OnSearchFieldChange(event)"/>
        <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
        </div>
      </li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
    </ul>
  </div>
<h1>numeric/matrix/tiles_algorithms.hpp</h1><a href="tiles__algorithms_8hpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/*</span>
<a name="l00002"></a>00002 <span class="comment"> * Ambient, License - Version 1.0 - May 3rd, 2012</span>
<a name="l00003"></a>00003 <span class="comment"> *</span>
<a name="l00004"></a>00004 <span class="comment"> * Permission is hereby granted, free of charge, to any person or organization</span>
<a name="l00005"></a>00005 <span class="comment"> * obtaining a copy of the software and accompanying documentation covered by</span>
<a name="l00006"></a>00006 <span class="comment"> * this license (the &quot;Software&quot;) to use, reproduce, display, distribute,</span>
<a name="l00007"></a>00007 <span class="comment"> * execute, and transmit the Software, and to prepare derivative works of the</span>
<a name="l00008"></a>00008 <span class="comment"> * Software, and to permit third-parties to whom the Software is furnished to</span>
<a name="l00009"></a>00009 <span class="comment"> * do so, all subject to the following:</span>
<a name="l00010"></a>00010 <span class="comment"> *</span>
<a name="l00011"></a>00011 <span class="comment"> * The copyright notices in the Software and this entire statement, including</span>
<a name="l00012"></a>00012 <span class="comment"> * the above license grant, this restriction and the following disclaimer,</span>
<a name="l00013"></a>00013 <span class="comment"> * must be included in all copies of the Software, in whole or in part, and</span>
<a name="l00014"></a>00014 <span class="comment"> * all derivative works of the Software, unless such copies or derivative</span>
<a name="l00015"></a>00015 <span class="comment"> * works are solely in the form of machine-executable object code generated by</span>
<a name="l00016"></a>00016 <span class="comment"> * a source language processor.</span>
<a name="l00017"></a>00017 <span class="comment"> *</span>
<a name="l00018"></a>00018 <span class="comment"> * THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR</span>
<a name="l00019"></a>00019 <span class="comment"> * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,</span>
<a name="l00020"></a>00020 <span class="comment"> * FITNESS FOR A PARTICULAR PURPOSE, TITLE AND NON-INFRINGEMENT. IN NO EVENT</span>
<a name="l00021"></a>00021 <span class="comment"> * SHALL THE COPYRIGHT HOLDERS OR ANYONE DISTRIBUTING THE SOFTWARE BE LIABLE</span>
<a name="l00022"></a>00022 <span class="comment"> * FOR ANY DAMAGES OR OTHER LIABILITY, WHETHER IN CONTRACT, TORT OR OTHERWISE,</span>
<a name="l00023"></a>00023 <span class="comment"> * ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER</span>
<a name="l00024"></a>00024 <span class="comment"> * DEALINGS IN THE SOFTWARE.</span>
<a name="l00025"></a>00025 <span class="comment"> */</span>
<a name="l00026"></a>00026 
<a name="l00027"></a>00027 <span class="preprocessor">#ifndef AMBIENT_NUMERIC_TILES_ALGORITHMS</span>
<a name="l00028"></a>00028 <span class="preprocessor"></span><span class="preprocessor">#define AMBIENT_NUMERIC_TILES_ALGORITHMS</span>
<a name="l00029"></a>00029 <span class="preprocessor"></span>
<a name="l00030"></a>00030 <span class="preprocessor">#include &quot;<a class="code" href="tiles_8h.html">ambient/numeric/matrix/tiles.h</a>&quot;</span>
<a name="l00031"></a>00031 <span class="preprocessor">#include &lt;utility&gt;</span>
<a name="l00032"></a>00032 
<a name="l00033"></a><a class="code" href="tiles__algorithms_8hpp.html#a77d3f6a01bab89b6b730110f7809ead6">00033</a> <span class="preprocessor">#define value_type      typename tiles&lt;Matrix&gt;::value_type</span>
<a name="l00034"></a><a class="code" href="tiles__algorithms_8hpp.html#adead3ef83e9181db3b1d4d7d098a18c0">00034</a> <span class="preprocessor"></span><span class="preprocessor">#define size_type       typename tiles&lt;Matrix&gt;::size_type</span>
<a name="l00035"></a><a class="code" href="tiles__algorithms_8hpp.html#a731a48e08c9b18c801b19dba5392ebd3">00035</a> <span class="preprocessor"></span><span class="preprocessor">#define real_type       typename tiles&lt;Matrix&gt;::real_type</span>
<a name="l00036"></a><a class="code" href="tiles__algorithms_8hpp.html#a1b219a1973718b5152571564b58dada7">00036</a> <span class="preprocessor"></span><span class="preprocessor">#define scalar_type     typename tiles&lt;Matrix&gt;::scalar_type</span>
<a name="l00037"></a><a class="code" href="tiles__algorithms_8hpp.html#a1602baf245550f2a6d2fc0b81ff9cf3e">00037</a> <span class="preprocessor"></span><span class="preprocessor">#define allocator_type  typename tiles&lt;Matrix&gt;::allocator_type</span>
<a name="l00038"></a>00038 <span class="preprocessor"></span>
<a name="l00039"></a>00039 <span class="keyword">namespace </span>ambient { <span class="keyword">namespace </span>numeric {
<a name="l00040"></a>00040 
<a name="l00041"></a><a class="code" href="classambient_1_1numeric_1_1cross__iterator.html">00041</a>     <span class="keyword">class </span><a class="code" href="classambient_1_1numeric_1_1cross__iterator.html">cross_iterator</a> {
<a name="l00042"></a>00042     <span class="keyword">public</span>:
<a name="l00043"></a><a class="code" href="classambient_1_1numeric_1_1cross__iterator.html#a68df79513788f4193157d7e2277fdcdd">00043</a>         <a class="code" href="classambient_1_1numeric_1_1cross__iterator.html#a68df79513788f4193157d7e2277fdcdd">cross_iterator</a>(<span class="keywordtype">size_t</span> <a class="code" href="classambient_1_1numeric_1_1cross__iterator.html#a42fc59aa250c9dbcbf6ef1f52d9ea06e">first</a>, <span class="keywordtype">size_t</span> <a class="code" href="classambient_1_1numeric_1_1cross__iterator.html#aa74d0adf620d19213c20e3fc10dd31a9">second</a>, <span class="keywordtype">size_t</span> size) 
<a name="l00044"></a>00044         : first(first), second(second), <a class="code" href="classambient_1_1numeric_1_1cross__iterator.html#a543d5625863add44616647f18c347a76">lim</a>(first+size){
<a name="l00045"></a>00045             <a class="code" href="classambient_1_1numeric_1_1cross__iterator.html#a57d9bd75c2ddae3ca6a0b76b53d3ede7">measure_step</a>();
<a name="l00046"></a>00046         }
<a name="l00047"></a><a class="code" href="classambient_1_1numeric_1_1cross__iterator.html#a13e06d7593bee614c2479053cbfd42a5">00047</a>         <span class="keywordtype">void</span> <a class="code" href="classambient_1_1numeric_1_1cross__iterator.html#a13e06d7593bee614c2479053cbfd42a5">operator++ </a>(){
<a name="l00048"></a>00048             <a class="code" href="classambient_1_1numeric_1_1cross__iterator.html#a42fc59aa250c9dbcbf6ef1f52d9ea06e">first</a>  += <a class="code" href="classambient_1_1numeric_1_1cross__iterator.html#ab9de065045fabb60dd74ed1fc8f8577b">step</a>;
<a name="l00049"></a>00049             <a class="code" href="classambient_1_1numeric_1_1cross__iterator.html#aa74d0adf620d19213c20e3fc10dd31a9">second</a> += <a class="code" href="classambient_1_1numeric_1_1cross__iterator.html#ab9de065045fabb60dd74ed1fc8f8577b">step</a>;
<a name="l00050"></a>00050             <a class="code" href="classambient_1_1numeric_1_1cross__iterator.html#a57d9bd75c2ddae3ca6a0b76b53d3ede7">measure_step</a>();
<a name="l00051"></a>00051         }
<a name="l00052"></a><a class="code" href="classambient_1_1numeric_1_1cross__iterator.html#a4e34bdb977852e1b193087ef1879146c">00052</a>         <span class="keywordtype">bool</span> <a class="code" href="classambient_1_1numeric_1_1cross__iterator.html#a4e34bdb977852e1b193087ef1879146c">end</a>(){
<a name="l00053"></a>00053             <span class="keywordflow">return</span> (<a class="code" href="classambient_1_1numeric_1_1cross__iterator.html#a42fc59aa250c9dbcbf6ef1f52d9ea06e">first</a> &gt;= <a class="code" href="classambient_1_1numeric_1_1cross__iterator.html#a543d5625863add44616647f18c347a76">lim</a>);
<a name="l00054"></a>00054         }
<a name="l00055"></a><a class="code" href="classambient_1_1numeric_1_1cross__iterator.html#a57d9bd75c2ddae3ca6a0b76b53d3ede7">00055</a>         <span class="keywordtype">void</span> <a class="code" href="classambient_1_1numeric_1_1cross__iterator.html#a57d9bd75c2ddae3ca6a0b76b53d3ede7">measure_step</a>(){
<a name="l00056"></a>00056             <a class="code" href="classambient_1_1numeric_1_1cross__iterator.html#ab9de065045fabb60dd74ed1fc8f8577b">step</a> = std::min(std::min((<a class="code" href="ambient_8hpp.html#a4c631df560c1ac2dd208c0cb9ff72a4c">AMBIENT_IB</a>*<a class="code" href="utils_2math_8hpp.html#aa429746c3d7ccb89f580e62ddcbe1fe7">__a_ceil</a>((<a class="code" href="classambient_1_1numeric_1_1cross__iterator.html#a42fc59aa250c9dbcbf6ef1f52d9ea06e">first</a>+1)/<a class="code" href="ambient_8hpp.html#a4c631df560c1ac2dd208c0cb9ff72a4c">AMBIENT_IB</a>) - <a class="code" href="classambient_1_1numeric_1_1cross__iterator.html#a42fc59aa250c9dbcbf6ef1f52d9ea06e">first</a>), 
<a name="l00057"></a>00057                                      (<a class="code" href="ambient_8hpp.html#a4c631df560c1ac2dd208c0cb9ff72a4c">AMBIENT_IB</a>*<a class="code" href="utils_2math_8hpp.html#aa429746c3d7ccb89f580e62ddcbe1fe7">__a_ceil</a>((<a class="code" href="classambient_1_1numeric_1_1cross__iterator.html#aa74d0adf620d19213c20e3fc10dd31a9">second</a>+1)/<a class="code" href="ambient_8hpp.html#a4c631df560c1ac2dd208c0cb9ff72a4c">AMBIENT_IB</a>) - <a class="code" href="classambient_1_1numeric_1_1cross__iterator.html#aa74d0adf620d19213c20e3fc10dd31a9">second</a>)),
<a name="l00058"></a>00058                                      (<a class="code" href="classambient_1_1numeric_1_1cross__iterator.html#a543d5625863add44616647f18c347a76">lim</a>-<a class="code" href="classambient_1_1numeric_1_1cross__iterator.html#a42fc59aa250c9dbcbf6ef1f52d9ea06e">first</a>));
<a name="l00059"></a>00059         }
<a name="l00060"></a><a class="code" href="classambient_1_1numeric_1_1cross__iterator.html#a42fc59aa250c9dbcbf6ef1f52d9ea06e">00060</a>         <span class="keywordtype">size_t</span> <a class="code" href="classambient_1_1numeric_1_1cross__iterator.html#a42fc59aa250c9dbcbf6ef1f52d9ea06e">first</a>;
<a name="l00061"></a><a class="code" href="classambient_1_1numeric_1_1cross__iterator.html#aa74d0adf620d19213c20e3fc10dd31a9">00061</a>         <span class="keywordtype">size_t</span> <a class="code" href="classambient_1_1numeric_1_1cross__iterator.html#aa74d0adf620d19213c20e3fc10dd31a9">second</a>;
<a name="l00062"></a><a class="code" href="classambient_1_1numeric_1_1cross__iterator.html#ab9de065045fabb60dd74ed1fc8f8577b">00062</a>         <span class="keywordtype">size_t</span> <a class="code" href="classambient_1_1numeric_1_1cross__iterator.html#ab9de065045fabb60dd74ed1fc8f8577b">step</a>;
<a name="l00063"></a><a class="code" href="classambient_1_1numeric_1_1cross__iterator.html#a543d5625863add44616647f18c347a76">00063</a>         <span class="keywordtype">size_t</span> <a class="code" href="classambient_1_1numeric_1_1cross__iterator.html#a543d5625863add44616647f18c347a76">lim</a>;
<a name="l00064"></a>00064     };
<a name="l00065"></a>00065 
<a name="l00066"></a>00066     <span class="keyword">template</span>&lt;<span class="keyword">class</span> Matrix&gt;
<a name="l00067"></a><a class="code" href="namespaceambient_1_1numeric.html#a51e2712a7bec38cbfd4f2111c58019fd">00067</a>     <span class="keywordtype">bool</span> <a class="code" href="namespaceambient_1_1numeric.html#aefb54c1a5f092c98361658a1ba2ddc93">is_hermitian</a>(<span class="keyword">const</span> <a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles&lt;Matrix&gt;</a>&amp; a){
<a name="l00068"></a>00068         <span class="keywordflow">if</span>(<a class="code" href="namespaceambient_1_1numeric.html#a0fecbb64cb533f5bb0dd8e6522b2161e">num_rows</a>(a) != <a class="code" href="namespaceambient_1_1numeric.html#ab3fc6c53a7c80693b666ffb7462177ba">num_cols</a>(a)) <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00069"></a>00069         <span class="comment">// return (a == transpose(conj(a))); // short version</span>
<a name="l00070"></a>00070 
<a name="l00071"></a>00071         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="namespaceambient_1_1numeric.html#a0fecbb64cb533f5bb0dd8e6522b2161e">num_rows</a>(a); ++i)
<a name="l00072"></a>00072         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j = 0; j &lt; <a class="code" href="namespaceambient_1_1numeric.html#ab3fc6c53a7c80693b666ffb7462177ba">num_cols</a>(a); ++j)
<a name="l00073"></a>00073         <span class="keywordflow">if</span>( std::abs( a(i,j) - <a class="code" href="namespaceambient_1_1numeric.html#a1ac1b2cef8ad63a25ffa2d254b7110d1">std::conj</a>(a(j,i)) ) &gt; 1e-10 )
<a name="l00074"></a>00074             <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00075"></a>00075         <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00076"></a>00076     }
<a name="l00077"></a>00077 
<a name="l00078"></a>00078     <span class="keyword">template</span>&lt;<span class="keyword">class</span> Matrix&gt;
<a name="l00079"></a><a class="code" href="namespaceambient_1_1numeric.html#a459ee4152ff5cb12a4b7072cbacebec0">00079</a>     <span class="keyword">inline</span> <a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles&lt;Matrix&gt;</a> <a class="code" href="namespaceambient_1_1numeric.html#a53bc3f322611470fe4e41345d84bd387">inverse</a>(<a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles&lt;Matrix&gt;</a> a){
<a name="l00080"></a>00080         <a class="code" href="namespaceambient_1_1numeric.html#aad8a5ccb79ca8d0fa12304fe45e50f0d">merge</a>(a); 
<a name="l00081"></a>00081         <a class="code" href="namespaceambient_1_1numeric.html#a53bc3f322611470fe4e41345d84bd387">inverse</a>(a[0]);
<a name="l00082"></a>00082         <a class="code" href="namespaceambient_1_1numeric.html#a6873c8866af05cc4580a86aab25593fb">split</a>(a);
<a name="l00083"></a>00083         <span class="keywordflow">return</span> a;
<a name="l00084"></a>00084     } 
<a name="l00085"></a>00085 
<a name="l00086"></a>00086     <span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt; <span class="comment">//  C - Tim, Alex I changed the name exp to expi due to the exp and a redondancy name</span>
<a name="l00087"></a><a class="code" href="namespaceambient_1_1numeric.html#a1fd96c380844b560a9e00b82d4046f18">00087</a>     <span class="keyword">inline</span> <a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles&lt;diagonal_matrix&lt;T&gt;</a> &gt; <a class="code" href="namespaceambient_1_1numeric.html#a1fd96c380844b560a9e00b82d4046f18">expi</a>(<span class="keyword">const</span> <a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles</a>&lt;<a class="code" href="classambient_1_1numeric_1_1diagonal__matrix.html">diagonal_matrix&lt;T&gt;</a> &gt;&amp; a, <span class="keyword">const</span> T&amp; alfa = 1.){
<a name="l00088"></a>00088         <a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles&lt;diagonal_matrix&lt;T&gt;</a> &gt; b(a); 
<a name="l00089"></a>00089         <a class="code" href="namespaceambient_1_1numeric.html#a91dc584c7cb0b79710a61064fb831aa6">exp_inplace</a>(b,alfa);
<a name="l00090"></a>00090         <span class="keywordflow">return</span> b;
<a name="l00091"></a>00091     }
<a name="l00092"></a>00092 
<a name="l00093"></a>00093     <span class="keyword">template</span>&lt;<span class="keyword">class</span> Matrix&gt;
<a name="l00094"></a><a class="code" href="namespaceambient_1_1numeric.html#aa02007921bb42b09e98d9715096f149a">00094</a>     <span class="keyword">inline</span> <a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles&lt;Matrix&gt;</a> <a class="code" href="namespaceambient_1_1numeric.html#ac96f3bd72ef5eb4a6227d36f99063d5e">exp</a>(<a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles&lt;Matrix&gt;</a> a, <span class="keyword">const</span> <a class="code" href="diagonal__matrix_8hpp.html#a77d3f6a01bab89b6b730110f7809ead6">value_type</a>&amp; alfa = 1.){
<a name="l00095"></a>00095         BOOST_STATIC_ASSERT( boost::is_complex&lt;value_type&gt;::value ); <span class="comment">// exp(complex), exp_hermitian(double and complex) : dummy name</span>
<a name="l00096"></a>00096         assert(<a class="code" href="namespaceambient_1_1numeric.html#a0fecbb64cb533f5bb0dd8e6522b2161e">num_rows</a>(a) == <a class="code" href="namespaceambient_1_1numeric.html#ab3fc6c53a7c80693b666ffb7462177ba">num_cols</a>(a));
<a name="l00097"></a>00097         std::size_t n = <a class="code" href="namespaceambient_1_1numeric.html#ab3fc6c53a7c80693b666ffb7462177ba">num_cols</a>(a);
<a name="l00098"></a>00098 
<a name="l00099"></a>00099         <a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles&lt;Matrix&gt;</a> Nr(n, n), Nl(n, n);
<a name="l00100"></a>00100         <a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles&lt;diagonal_matrix&lt;value_type&gt;</a> &gt; Sv(<a class="code" href="namespaceambient_1_1numeric.html#a0fecbb64cb533f5bb0dd8e6522b2161e">num_rows</a>(a), <a class="code" href="namespaceambient_1_1numeric.html#a0fecbb64cb533f5bb0dd8e6522b2161e">num_rows</a>(a)); 
<a name="l00101"></a>00101  
<a name="l00102"></a>00102         <a class="code" href="namespaceambient_1_1numeric.html#a67e0af4076f194a802732cadb0d19323">geev</a>(a, Nl, Nr, Sv);        
<a name="l00103"></a>00103       
<a name="l00104"></a>00104         <a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles&lt;Matrix&gt;</a> Nrinv = <a class="code" href="namespaceambient_1_1numeric.html#a53bc3f322611470fe4e41345d84bd387">inverse</a>(Nr);  
<a name="l00105"></a>00105         <a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles&lt;diagonal_matrix&lt;value_type&gt;</a> &gt; S(<a class="code" href="namespaceambient_1_1numeric.html#a0fecbb64cb533f5bb0dd8e6522b2161e">num_rows</a>(a), <a class="code" href="namespaceambient_1_1numeric.html#a0fecbb64cb533f5bb0dd8e6522b2161e">num_rows</a>(a)); 
<a name="l00106"></a>00106 
<a name="l00107"></a>00107         S = <a class="code" href="namespaceambient_1_1numeric.html#a1fd96c380844b560a9e00b82d4046f18">expi</a>(Sv, alfa); <span class="comment">//complex-complex</span>
<a name="l00108"></a>00108 
<a name="l00109"></a>00109         <a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles&lt;Matrix&gt;</a> tmp(n,n);
<a name="l00110"></a>00110 
<a name="l00111"></a>00111         <a class="code" href="namespaceambient_1_1numeric.html#a965d006c32a4faf1dda4b4305f096b4c">gemm</a>(Nr, S, tmp);
<a name="l00112"></a>00112         <a class="code" href="namespaceambient_1_1numeric.html#a965d006c32a4faf1dda4b4305f096b4c">gemm</a>(tmp, Nrinv, a);
<a name="l00113"></a>00113 
<a name="l00114"></a>00114         <span class="keywordflow">return</span> a;
<a name="l00115"></a>00115     }
<a name="l00116"></a>00116 
<a name="l00117"></a>00117     <span class="keyword">template</span>&lt;<span class="keyword">class</span> Matrix&gt;
<a name="l00118"></a><a class="code" href="namespaceambient_1_1numeric.html#ac6322d1f51f5fdf53ae1a5d541e4fab2">00118</a>     <span class="keyword">inline</span> <a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles&lt;Matrix&gt;</a> <a class="code" href="namespaceambient_1_1numeric.html#ac6322d1f51f5fdf53ae1a5d541e4fab2">exp_hermitian</a>(<a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles&lt;Matrix&gt;</a> a, <span class="keyword">const</span> <a class="code" href="diagonal__matrix_8hpp.html#a77d3f6a01bab89b6b730110f7809ead6">value_type</a>&amp; alfa = 1.){
<a name="l00119"></a>00119         assert(<a class="code" href="namespaceambient_1_1numeric.html#a0fecbb64cb533f5bb0dd8e6522b2161e">num_rows</a>(a) == <a class="code" href="namespaceambient_1_1numeric.html#ab3fc6c53a7c80693b666ffb7462177ba">num_cols</a>(a));
<a name="l00120"></a>00120         std::size_t n = <a class="code" href="namespaceambient_1_1numeric.html#ab3fc6c53a7c80693b666ffb7462177ba">num_cols</a>(a);
<a name="l00121"></a>00121         <a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles&lt;diagonal_matrix&lt;double&gt;</a> &gt; Sv(n,n);
<a name="l00122"></a>00122         <a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles&lt;Matrix&gt;</a> tmp(n,n), N(n,n);
<a name="l00123"></a>00123    
<a name="l00124"></a>00124         <a class="code" href="namespaceambient_1_1numeric.html#a61a9ca3315a26fc6d0b6dd66e97e026e">heev</a>(a, N, Sv);
<a name="l00125"></a>00125 
<a name="l00126"></a>00126         <a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles&lt;diagonal_matrix&lt;value_type&gt;</a> &gt; S(n,n), S1(n,n); 
<a name="l00127"></a>00127 
<a name="l00128"></a>00128         <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> k = 0; k &lt; Sv.<a class="code" href="classambient_1_1numeric_1_1tiles.html#a7de1e2d16bff37382057a7b19b699701">data</a>.size(); ++k)
<a name="l00129"></a>00129              ambient::numeric::kernels::template cast_double_complex&lt;value_type,double&gt;(S[k],Sv[k]); <span class="comment">//can be complex/double or double/double</span>
<a name="l00130"></a>00130 
<a name="l00131"></a>00131         S1 = <a class="code" href="namespaceambient_1_1numeric.html#a1fd96c380844b560a9e00b82d4046f18">expi</a>(S,alfa); 
<a name="l00132"></a>00132         <a class="code" href="namespaceambient_1_1numeric.html#a965d006c32a4faf1dda4b4305f096b4c">gemm</a>(N, S1, tmp);
<a name="l00133"></a>00133         <a class="code" href="namespaceambient_1_1numeric.html#a965d006c32a4faf1dda4b4305f096b4c">gemm</a>(tmp, <a class="code" href="namespaceambient_1_1numeric.html#a4f2b4f15889cf29c28de8b416ab4b29f">adjoint</a>(N), a);
<a name="l00134"></a>00134 
<a name="l00135"></a>00135         <span class="keywordflow">return</span> a; 
<a name="l00136"></a>00136     }
<a name="l00137"></a>00137 
<a name="l00138"></a>00138     <span class="keyword">template</span>&lt;<span class="keyword">class</span> Matrix&gt;
<a name="l00139"></a><a class="code" href="namespaceambient_1_1numeric.html#a71969ea146f171df5377d397fbbf2b95">00139</a>     <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="namespaceambient_1_1numeric.html#a67e0af4076f194a802732cadb0d19323">geev</a>(<a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles&lt;Matrix&gt;</a> a, <a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles&lt;Matrix&gt;</a>&amp; lv, <a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles&lt;Matrix&gt;</a>&amp; rv, <a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles</a>&lt;<a class="code" href="classambient_1_1numeric_1_1diagonal__matrix.html">diagonal_matrix&lt;value_type&gt;</a> &gt;&amp; s){
<a name="l00140"></a>00140         <a class="code" href="namespaceambient_1_1numeric.html#aad8a5ccb79ca8d0fa12304fe45e50f0d">merge</a>(a); <a class="code" href="namespaceambient_1_1numeric.html#aad8a5ccb79ca8d0fa12304fe45e50f0d">merge</a>(lv); <a class="code" href="namespaceambient_1_1numeric.html#aad8a5ccb79ca8d0fa12304fe45e50f0d">merge</a>(rv); <a class="code" href="namespaceambient_1_1numeric.html#aad8a5ccb79ca8d0fa12304fe45e50f0d">merge</a>(s);
<a name="l00141"></a>00141         <a class="code" href="namespaceambient_1_1numeric.html#a67e0af4076f194a802732cadb0d19323">geev</a>(a[0],lv[0],rv[0],s[0]);
<a name="l00142"></a>00142         <a class="code" href="namespaceambient_1_1numeric.html#a6873c8866af05cc4580a86aab25593fb">split</a>(lv); <a class="code" href="namespaceambient_1_1numeric.html#a6873c8866af05cc4580a86aab25593fb">split</a>(rv); <a class="code" href="namespaceambient_1_1numeric.html#a6873c8866af05cc4580a86aab25593fb">split</a>(s);
<a name="l00143"></a>00143     }
<a name="l00144"></a>00144 
<a name="l00145"></a>00145     <span class="keyword">template</span>&lt;<span class="keyword">class</span> Matrix&gt;
<a name="l00146"></a><a class="code" href="namespaceambient_1_1numeric.html#aec1863f635cf4f22e63199f7bd2f4cca">00146</a>     <span class="keyword">inline</span> <span class="keyword">const</span> <a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles&lt;Matrix&gt;</a> <a class="code" href="namespaceambient_1_1numeric.html#a1ac1b2cef8ad63a25ffa2d254b7110d1">conj</a>(<span class="keyword">const</span> <a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles&lt;Matrix&gt;</a>&amp; a){
<a name="l00147"></a>00147         <a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles&lt;Matrix&gt;</a> b(a); 
<a name="l00148"></a>00148         <a class="code" href="namespaceambient_1_1numeric.html#a1d6e02976473f0adbd0cddaf46a1cd57">conj_inplace</a>(b);
<a name="l00149"></a>00149         <span class="keywordflow">return</span> b; 
<a name="l00150"></a>00150     }
<a name="l00151"></a>00151 
<a name="l00152"></a>00152     <span class="keyword">template</span>&lt;<span class="keyword">class</span> Matrix&gt;
<a name="l00153"></a><a class="code" href="namespaceambient_1_1numeric.html#abdf77b9970412f7f6535016a653a402a">00153</a>     <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="namespaceambient_1_1numeric.html#a1d6e02976473f0adbd0cddaf46a1cd57">conj_inplace</a>(<a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles&lt;Matrix&gt;</a>&amp; a){
<a name="l00154"></a>00154         <span class="keywordtype">int</span> size = a.<a class="code" href="classambient_1_1numeric_1_1tiles.html#a7de1e2d16bff37382057a7b19b699701">data</a>.size();
<a name="l00155"></a>00155         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; size; i++)
<a name="l00156"></a>00156             <a class="code" href="namespaceambient_1_1numeric.html#a1d6e02976473f0adbd0cddaf46a1cd57">conj_inplace</a>(a[i]);
<a name="l00157"></a>00157     }
<a name="l00158"></a>00158 
<a name="l00159"></a>00159     <span class="keyword">template</span> &lt;<span class="keyword">class</span> MatrixA, <span class="keyword">class</span> MatrixB&gt;
<a name="l00160"></a><a class="code" href="namespaceambient_1_1numeric.html#accf969a74167f79b219d7c2fc21f4c42">00160</a>     <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="namespaceambient_1_1numeric.html#a72af6c400c25399f7e44d0402ccde6a7">mul_inplace</a>(<a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles&lt;MatrixA&gt;</a>&amp; a, <span class="keyword">const</span> <a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles&lt;MatrixB&gt;</a>&amp; rhs){
<a name="l00161"></a>00161         <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;Error: not tested mul inplace&quot;</span>);
<a name="l00162"></a>00162     }
<a name="l00163"></a>00163 
<a name="l00164"></a>00164     <span class="keyword">template</span> &lt;<span class="keyword">class</span> Matrix&gt;
<a name="l00165"></a><a class="code" href="namespaceambient_1_1numeric.html#a778cadb80b3d403b236b7a688ced1341">00165</a>     <span class="keyword">inline</span> <a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles&lt;Matrix&gt;</a> <a class="code" href="namespaceambient_1_1numeric.html#a778cadb80b3d403b236b7a688ced1341">kron</a>(<span class="keyword">const</span> <a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles&lt;Matrix&gt;</a>&amp; M1, <span class="keyword">const</span> <a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles&lt;Matrix&gt;</a>&amp; M2){
<a name="l00166"></a>00166         <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;Error: not tested kron&quot;</span>);
<a name="l00167"></a>00167     }
<a name="l00168"></a>00168  
<a name="l00169"></a>00169     <span class="keyword">template</span>&lt;<span class="keyword">class</span> Matrix&gt;
<a name="l00170"></a><a class="code" href="namespaceambient_1_1numeric.html#aad8a5ccb79ca8d0fa12304fe45e50f0d">00170</a>     <span class="keyword">inline</span> Matrix* <a class="code" href="namespaceambient_1_1numeric.html#aad8a5ccb79ca8d0fa12304fe45e50f0d">merge</a>(<span class="keyword">const</span> <a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles</a>&lt;<a class="code" href="classambient_1_1numeric_1_1subset__view.html">subset_view&lt;Matrix&gt;</a> &gt;&amp; a){
<a name="l00171"></a>00171         Matrix* m = <span class="keyword">new</span> Matrix(a.rows, a.cols);
<a name="l00172"></a>00172 
<a name="l00173"></a>00173         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j = 0; j &lt; a.nt; j++){
<a name="l00174"></a>00174             <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; a.mt; i++){
<a name="l00175"></a>00175                 <span class="keyword">const</span> Matrix* src = &amp;a.tile(i,j);
<a name="l00176"></a>00176                 <a class="code" href="namespaceambient_1_1numeric.html#a3f527b5b6f1fc0beb1523eea6981e39c">copy_block</a>(*src, 0, 0, *m, i*<a class="code" href="ambient_8hpp.html#a4c631df560c1ac2dd208c0cb9ff72a4c">AMBIENT_IB</a>, j*AMBIENT_IB, src-&gt;num_rows(), src-&gt;num_cols());
<a name="l00177"></a>00177             }
<a name="l00178"></a>00178         }
<a name="l00179"></a>00179         <span class="keywordflow">return</span> m;
<a name="l00180"></a>00180     }
<a name="l00181"></a>00181 
<a name="l00182"></a>00182     <span class="keyword">template</span>&lt;<span class="keyword">class</span> Matrix&gt;
<a name="l00183"></a><a class="code" href="namespaceambient_1_1numeric.html#a6873c8866af05cc4580a86aab25593fb">00183</a>     <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="namespaceambient_1_1numeric.html#a6873c8866af05cc4580a86aab25593fb">split</a>(<span class="keyword">const</span> <a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles</a>&lt;<a class="code" href="classambient_1_1numeric_1_1transpose__view.html">transpose_view&lt;Matrix&gt;</a> &gt;&amp; a){
<a name="l00184"></a>00184         printf(<span class="stringliteral">&quot;SPLIT OF TRANSPOSE VIEW!\n\n\n&quot;</span>);
<a name="l00185"></a>00185         <span class="keywordflow">if</span>(a.data.size() == 1 &amp;&amp; (<a class="code" href="utils_2math_8hpp.html#aa429746c3d7ccb89f580e62ddcbe1fe7">__a_ceil</a>(a.rows/<a class="code" href="ambient_8hpp.html#a4c631df560c1ac2dd208c0cb9ff72a4c">AMBIENT_IB</a>) != 1 || <a class="code" href="utils_2math_8hpp.html#aa429746c3d7ccb89f580e62ddcbe1fe7">__a_ceil</a>(a.cols/<a class="code" href="ambient_8hpp.html#a4c631df560c1ac2dd208c0cb9ff72a4c">AMBIENT_IB</a>) != 1)) printf(<span class="stringliteral">&quot;We have to split but we don&apos;t :(\n&quot;</span>);
<a name="l00186"></a>00186     }
<a name="l00187"></a>00187 
<a name="l00188"></a>00188     <span class="comment">// {{{ normal merge / split</span>
<a name="l00189"></a>00189     
<a name="l00190"></a>00190     <span class="keyword">template</span>&lt;<span class="keyword">class</span> Matrix&gt;
<a name="l00191"></a><a class="code" href="namespaceambient_1_1numeric.html#a95b1a72580001389deed82b1e8874923">00191</a>     <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="namespaceambient_1_1numeric.html#aad8a5ccb79ca8d0fa12304fe45e50f0d">merge</a>(<span class="keyword">const</span> <a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles&lt;Matrix&gt;</a>&amp; a){
<a name="l00192"></a>00192         <span class="keywordflow">if</span>(a.<a class="code" href="classambient_1_1numeric_1_1tiles.html#a7de1e2d16bff37382057a7b19b699701">data</a>.size() == 1) <span class="keywordflow">return</span>;
<a name="l00193"></a>00193 
<a name="l00194"></a>00194         std::vector&lt;Matrix*&gt; m; 
<a name="l00195"></a>00195         m.push_back(<span class="keyword">new</span> Matrix(a.<a class="code" href="classambient_1_1numeric_1_1tiles.html#a9257eef3b2adff33d7a3f5c7904b56e0">rows</a>, a.<a class="code" href="classambient_1_1numeric_1_1tiles.html#a47bef350fa50322c7eaec2379a0f5f51">cols</a>));
<a name="l00196"></a>00196 
<a name="l00197"></a>00197         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j = 0; j &lt; a.<a class="code" href="classambient_1_1numeric_1_1tiles.html#a0034807b433e5a3cd1e1ce8feccdd943">nt</a>; j++){
<a name="l00198"></a>00198             <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; a.<a class="code" href="classambient_1_1numeric_1_1tiles.html#af345221ac22302e8b33e60c122955c9c">mt</a>; i++){
<a name="l00199"></a>00199                 <span class="keyword">const</span> Matrix* src = &amp;a.<a class="code" href="classambient_1_1numeric_1_1tiles.html#a3354919fabbcd8b3e01700211a275d4e">tile</a>(i,j);
<a name="l00200"></a>00200                 <span class="keywordflow">if</span>(!<a class="code" href="namespaceambient.html#aa4601ed7e4dfa2cf93729c360bfeaf48">ambient::weak</a>(*src))
<a name="l00201"></a>00201                 <a class="code" href="namespaceambient_1_1numeric.html#a3f527b5b6f1fc0beb1523eea6981e39c">copy_block</a>(*src, 0, 0, *m[0], i*<a class="code" href="ambient_8hpp.html#a4c631df560c1ac2dd208c0cb9ff72a4c">AMBIENT_IB</a>, j*AMBIENT_IB, src-&gt;num_rows(), src-&gt;num_cols());
<a name="l00202"></a>00202                 <span class="keyword">delete</span> src;
<a name="l00203"></a>00203             }
<a name="l00204"></a>00204         }
<a name="l00205"></a>00205         <a class="code" href="namespaceambient_1_1numeric.html#a0a238b86490882169e691146684bee91">std::swap</a>(<span class="keyword">const_cast&lt;</span>std::vector&lt;Matrix*&gt;&amp;<span class="keyword">&gt;</span>(a.<a class="code" href="classambient_1_1numeric_1_1tiles.html#a7de1e2d16bff37382057a7b19b699701">data</a>), m);
<a name="l00206"></a>00206     }
<a name="l00207"></a>00207 
<a name="l00208"></a>00208     <span class="keyword">template</span>&lt;<span class="keyword">class</span> Matrix&gt;
<a name="l00209"></a><a class="code" href="namespaceambient_1_1numeric.html#a626d22444876bcae70a8e11b95c9b6b8">00209</a>     <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="namespaceambient_1_1numeric.html#a6873c8866af05cc4580a86aab25593fb">split</a>(<span class="keyword">const</span> <a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles&lt;Matrix&gt;</a>&amp; a){
<a name="l00210"></a>00210         <span class="keywordflow">if</span>(a.<a class="code" href="classambient_1_1numeric_1_1tiles.html#a7de1e2d16bff37382057a7b19b699701">data</a>.size() != 1) <span class="keywordflow">return</span>;
<a name="l00211"></a>00211         <span class="keywordflow">if</span>(a.<a class="code" href="classambient_1_1numeric_1_1tiles.html#af345221ac22302e8b33e60c122955c9c">mt</a> == 1 &amp;&amp; a.<a class="code" href="classambient_1_1numeric_1_1tiles.html#a0034807b433e5a3cd1e1ce8feccdd943">nt</a> == 1) <span class="keywordflow">return</span>;
<a name="l00212"></a>00212 
<a name="l00213"></a>00213         std::vector&lt;Matrix*&gt; s;
<a name="l00214"></a>00214         <span class="keywordtype">int</span> tailm = <a class="code" href="utils_2math_8hpp.html#a343eacb48f3fcb4c0cabb3efca9da618">__a_mod</a>(a.<a class="code" href="classambient_1_1numeric_1_1tiles.html#a9257eef3b2adff33d7a3f5c7904b56e0">rows</a>, <a class="code" href="ambient_8hpp.html#a4c631df560c1ac2dd208c0cb9ff72a4c">AMBIENT_IB</a>);
<a name="l00215"></a>00215         <span class="keywordtype">int</span> tailn = <a class="code" href="utils_2math_8hpp.html#a343eacb48f3fcb4c0cabb3efca9da618">__a_mod</a>(a.<a class="code" href="classambient_1_1numeric_1_1tiles.html#a47bef350fa50322c7eaec2379a0f5f51">cols</a>, <a class="code" href="ambient_8hpp.html#a4c631df560c1ac2dd208c0cb9ff72a4c">AMBIENT_IB</a>);
<a name="l00216"></a>00216         s.reserve(a.<a class="code" href="classambient_1_1numeric_1_1tiles.html#af345221ac22302e8b33e60c122955c9c">mt</a>*a.<a class="code" href="classambient_1_1numeric_1_1tiles.html#a0034807b433e5a3cd1e1ce8feccdd943">nt</a>);
<a name="l00217"></a>00217         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j = 1; j &lt; a.<a class="code" href="classambient_1_1numeric_1_1tiles.html#a0034807b433e5a3cd1e1ce8feccdd943">nt</a>; j++){
<a name="l00218"></a>00218             <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 1; i &lt; a.<a class="code" href="classambient_1_1numeric_1_1tiles.html#af345221ac22302e8b33e60c122955c9c">mt</a>; i++) 
<a name="l00219"></a>00219                 s.push_back(<span class="keyword">new</span> Matrix(<a class="code" href="ambient_8hpp.html#a4c631df560c1ac2dd208c0cb9ff72a4c">AMBIENT_IB</a>, <a class="code" href="ambient_8hpp.html#a4c631df560c1ac2dd208c0cb9ff72a4c">AMBIENT_IB</a>));
<a name="l00220"></a>00220             s.push_back(<span class="keyword">new</span> Matrix(tailm, <a class="code" href="ambient_8hpp.html#a4c631df560c1ac2dd208c0cb9ff72a4c">AMBIENT_IB</a>));
<a name="l00221"></a>00221         }
<a name="l00222"></a>00222         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 1; i &lt; a.<a class="code" href="classambient_1_1numeric_1_1tiles.html#af345221ac22302e8b33e60c122955c9c">mt</a>; i++) 
<a name="l00223"></a>00223             s.push_back(<span class="keyword">new</span> Matrix(<a class="code" href="ambient_8hpp.html#a4c631df560c1ac2dd208c0cb9ff72a4c">AMBIENT_IB</a>, tailn));
<a name="l00224"></a>00224         s.push_back(<span class="keyword">new</span> Matrix(tailm, tailn));
<a name="l00225"></a>00225 
<a name="l00226"></a>00226         <span class="keyword">const</span> Matrix* src = a.<a class="code" href="classambient_1_1numeric_1_1tiles.html#a7de1e2d16bff37382057a7b19b699701">data</a>[0];
<a name="l00227"></a>00227 
<a name="l00228"></a>00228         <span class="keywordflow">if</span>(!<a class="code" href="namespaceambient.html#aa4601ed7e4dfa2cf93729c360bfeaf48">ambient::weak</a>(a[0]))
<a name="l00229"></a>00229         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j = 0; j &lt; a.<a class="code" href="classambient_1_1numeric_1_1tiles.html#a0034807b433e5a3cd1e1ce8feccdd943">nt</a>; j++){
<a name="l00230"></a>00230             <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; a.<a class="code" href="classambient_1_1numeric_1_1tiles.html#af345221ac22302e8b33e60c122955c9c">mt</a>; i++){
<a name="l00231"></a>00231                 Matrix&amp; dst = *s[i+j*a.<a class="code" href="classambient_1_1numeric_1_1tiles.html#af345221ac22302e8b33e60c122955c9c">mt</a>];
<a name="l00232"></a>00232                 <a class="code" href="namespaceambient_1_1numeric.html#a3f527b5b6f1fc0beb1523eea6981e39c">copy_block</a>(*src, i*<a class="code" href="ambient_8hpp.html#a4c631df560c1ac2dd208c0cb9ff72a4c">AMBIENT_IB</a>, j*AMBIENT_IB, dst, 0, 0, dst.num_rows(), dst.num_cols());
<a name="l00233"></a>00233             }
<a name="l00234"></a>00234         }
<a name="l00235"></a>00235 
<a name="l00236"></a>00236         <span class="keyword">delete</span> src;
<a name="l00237"></a>00237         <a class="code" href="namespaceambient_1_1numeric.html#a0a238b86490882169e691146684bee91">std::swap</a>(<span class="keyword">const_cast&lt;</span>std::vector&lt;Matrix*&gt;&amp;<span class="keyword">&gt;</span>(a.<a class="code" href="classambient_1_1numeric_1_1tiles.html#a7de1e2d16bff37382057a7b19b699701">data</a>), s);
<a name="l00238"></a>00238     }
<a name="l00239"></a>00239 
<a name="l00240"></a>00240     <span class="comment">// }}}</span>
<a name="l00241"></a>00241     <span class="comment">// {{{ diagonal merge/split</span>
<a name="l00242"></a>00242 
<a name="l00243"></a>00243     <span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;
<a name="l00244"></a><a class="code" href="namespaceambient_1_1numeric.html#a2d7ede53d0e68c11df01e2d2844b6065">00244</a>     <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="namespaceambient_1_1numeric.html#aad8a5ccb79ca8d0fa12304fe45e50f0d">merge</a>(<span class="keyword">const</span> <a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles</a>&lt;<a class="code" href="classambient_1_1numeric_1_1diagonal__matrix.html">diagonal_matrix&lt;T&gt;</a> &gt;&amp; a){
<a name="l00245"></a>00245         <span class="keywordflow">if</span>(a.data.size() == 1) <span class="keywordflow">return</span>;
<a name="l00246"></a>00246 
<a name="l00247"></a>00247         std::vector&lt;diagonal_matrix&lt;T&gt; *&gt; m; 
<a name="l00248"></a>00248         m.push_back(<span class="keyword">new</span> <a class="code" href="classambient_1_1numeric_1_1diagonal__matrix.html">diagonal_matrix&lt;T&gt;</a>(a.size, a.size));
<a name="l00249"></a>00249 
<a name="l00250"></a>00250         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; a.nt; i++){
<a name="l00251"></a>00251             <span class="keyword">const</span> <a class="code" href="classambient_1_1numeric_1_1diagonal__matrix.html">diagonal_matrix&lt;T&gt;</a>* src = a.data[i];
<a name="l00252"></a>00252             <span class="keywordflow">if</span>(!<a class="code" href="namespaceambient.html#aa4601ed7e4dfa2cf93729c360bfeaf48">ambient::weak</a>(src-&gt;<a class="code" href="classambient_1_1numeric_1_1diagonal__matrix.html#adce2067c3d135e2a6bfa0885d29989b0">get_data</a>()))
<a name="l00253"></a>00253             <a class="code" href="namespaceambient_1_1numeric.html#a3f527b5b6f1fc0beb1523eea6981e39c">copy_block</a>(src-&gt;<a class="code" href="classambient_1_1numeric_1_1diagonal__matrix.html#adce2067c3d135e2a6bfa0885d29989b0">get_data</a>(), 0, 0, m[0]-&gt;get_data(), i*<a class="code" href="ambient_8hpp.html#a4c631df560c1ac2dd208c0cb9ff72a4c">AMBIENT_IB</a>, 0, src-&gt;<a class="code" href="classambient_1_1numeric_1_1diagonal__matrix.html#a237d322e4a70f01572d64406123831ae">num_rows</a>(), 1);
<a name="l00254"></a>00254             <span class="keyword">delete</span> src;
<a name="l00255"></a>00255         }
<a name="l00256"></a>00256         <a class="code" href="namespaceambient_1_1numeric.html#a0a238b86490882169e691146684bee91">std::swap</a>(<span class="keyword">const_cast&lt;</span>std::vector&lt;diagonal_matrix&lt;T&gt;*<span class="keyword">&gt;</span>&amp;&gt;(a.data), m);
<a name="l00257"></a>00257     }
<a name="l00258"></a>00258 
<a name="l00259"></a>00259     <span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;
<a name="l00260"></a><a class="code" href="namespaceambient_1_1numeric.html#a61774b06a466d72427f797c731d0d202">00260</a>     <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="namespaceambient_1_1numeric.html#a6873c8866af05cc4580a86aab25593fb">split</a>(<span class="keyword">const</span> <a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles</a>&lt;<a class="code" href="classambient_1_1numeric_1_1diagonal__matrix.html">diagonal_matrix&lt;T&gt;</a> &gt;&amp; a){
<a name="l00261"></a>00261         <span class="keywordflow">if</span>(a.data.size() != 1) <span class="keywordflow">return</span>;
<a name="l00262"></a>00262         <span class="keywordflow">if</span>(a.nt == 1) <span class="keywordflow">return</span>;
<a name="l00263"></a>00263 
<a name="l00264"></a>00264         std::vector&lt;diagonal_matrix&lt;T&gt; *&gt; s;
<a name="l00265"></a>00265         <span class="keywordtype">int</span> tailm = <a class="code" href="utils_2math_8hpp.html#a343eacb48f3fcb4c0cabb3efca9da618">__a_mod</a>(a.size, <a class="code" href="ambient_8hpp.html#a4c631df560c1ac2dd208c0cb9ff72a4c">AMBIENT_IB</a>);
<a name="l00266"></a>00266         s.reserve(a.nt);
<a name="l00267"></a>00267         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 1; i &lt; a.nt; i++) 
<a name="l00268"></a>00268             s.push_back(<span class="keyword">new</span> <a class="code" href="classambient_1_1numeric_1_1diagonal__matrix.html">diagonal_matrix&lt;T&gt;</a>(<a class="code" href="ambient_8hpp.html#a4c631df560c1ac2dd208c0cb9ff72a4c">AMBIENT_IB</a>, <a class="code" href="ambient_8hpp.html#a4c631df560c1ac2dd208c0cb9ff72a4c">AMBIENT_IB</a>));
<a name="l00269"></a>00269         s.push_back(<span class="keyword">new</span> <a class="code" href="classambient_1_1numeric_1_1diagonal__matrix.html">diagonal_matrix&lt;T&gt;</a>(tailm, tailm));
<a name="l00270"></a>00270 
<a name="l00271"></a>00271         <span class="keyword">const</span> <a class="code" href="classambient_1_1numeric_1_1diagonal__matrix.html">diagonal_matrix&lt;T&gt;</a>* src = a.data[0];
<a name="l00272"></a>00272 
<a name="l00273"></a>00273         <span class="keywordflow">if</span>(!<a class="code" href="namespaceambient.html#aa4601ed7e4dfa2cf93729c360bfeaf48">ambient::weak</a>(a[0].get_data()))
<a name="l00274"></a>00274         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; a.nt; i++){
<a name="l00275"></a>00275             <a class="code" href="classambient_1_1numeric_1_1diagonal__matrix.html">diagonal_matrix&lt;T&gt;</a>&amp; dst = *s[i];
<a name="l00276"></a>00276             <a class="code" href="namespaceambient_1_1numeric.html#a3f527b5b6f1fc0beb1523eea6981e39c">copy_block</a>(src-&gt;<a class="code" href="classambient_1_1numeric_1_1diagonal__matrix.html#adce2067c3d135e2a6bfa0885d29989b0">get_data</a>(), i*<a class="code" href="ambient_8hpp.html#a4c631df560c1ac2dd208c0cb9ff72a4c">AMBIENT_IB</a>, 0, dst.<a class="code" href="classambient_1_1numeric_1_1diagonal__matrix.html#adce2067c3d135e2a6bfa0885d29989b0">get_data</a>(), 0, 0, dst.<a class="code" href="classambient_1_1numeric_1_1diagonal__matrix.html#a237d322e4a70f01572d64406123831ae">num_rows</a>(), 1);
<a name="l00277"></a>00277         }
<a name="l00278"></a>00278 
<a name="l00279"></a>00279         <span class="keyword">delete</span> src;
<a name="l00280"></a>00280         <a class="code" href="namespaceambient_1_1numeric.html#a0a238b86490882169e691146684bee91">std::swap</a>(<span class="keyword">const_cast&lt;</span>std::vector&lt;diagonal_matrix&lt;T&gt;*<span class="keyword">&gt;</span>&amp;&gt;(a.data), s);
<a name="l00281"></a>00281     }
<a name="l00282"></a>00282 
<a name="l00283"></a>00283     <span class="comment">// }}}</span>
<a name="l00284"></a>00284 
<a name="l00285"></a>00285     <span class="keyword">template</span>&lt;<span class="keyword">class</span> MatrixA, <span class="keyword">class</span> MatrixB&gt;
<a name="l00286"></a><a class="code" href="namespaceambient_1_1numeric.html#a4d4cb67c6536806e4706da6464aeb73d">00286</a>     <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="namespaceambient_1_1numeric.html#a3f527b5b6f1fc0beb1523eea6981e39c">copy_block</a>(<span class="keyword">const</span> <a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles&lt;MatrixB&gt;</a>&amp; in, <span class="keywordtype">size_t</span> ii, <span class="keywordtype">size_t</span> ij,
<a name="l00287"></a>00287                            <a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles&lt;MatrixA&gt;</a>&amp; out, <span class="keywordtype">size_t</span> oi, <span class="keywordtype">size_t</span> oj, 
<a name="l00288"></a>00288                            <span class="keywordtype">size_t</span> m, <span class="keywordtype">size_t</span> n)
<a name="l00289"></a>00289     {
<a name="l00290"></a>00290         <span class="keywordflow">for</span>(<a class="code" href="classambient_1_1numeric_1_1cross__iterator.html">cross_iterator</a> row(oi,ii,m); !row.end(); ++row)
<a name="l00291"></a>00291         <span class="keywordflow">for</span>(<a class="code" href="classambient_1_1numeric_1_1cross__iterator.html">cross_iterator</a> col(oj,ij,n); !col.end(); ++col)
<a name="l00292"></a>00292         <a class="code" href="namespaceambient_1_1numeric.html#a3f527b5b6f1fc0beb1523eea6981e39c">copy_block</a>(in.<a class="code" href="classambient_1_1numeric_1_1tiles.html#a3f72c967ae50932204693bbb0720f07b">locate</a>(row.second, col.second), row.second%<a class="code" href="ambient_8hpp.html#a4c631df560c1ac2dd208c0cb9ff72a4c">AMBIENT_IB</a>, col.second%<a class="code" href="ambient_8hpp.html#a4c631df560c1ac2dd208c0cb9ff72a4c">AMBIENT_IB</a>,
<a name="l00293"></a>00293                    out.<a class="code" href="classambient_1_1numeric_1_1tiles.html#a3f72c967ae50932204693bbb0720f07b">locate</a>(row.first, col.first), row.first%<a class="code" href="ambient_8hpp.html#a4c631df560c1ac2dd208c0cb9ff72a4c">AMBIENT_IB</a>, col.first%<a class="code" href="ambient_8hpp.html#a4c631df560c1ac2dd208c0cb9ff72a4c">AMBIENT_IB</a>, 
<a name="l00294"></a>00294                    row.step, col.step);
<a name="l00295"></a>00295     }
<a name="l00296"></a>00296 
<a name="l00297"></a>00297     <span class="keyword">template</span>&lt;<span class="keyword">class</span> Matrix&gt;
<a name="l00298"></a><a class="code" href="namespaceambient_1_1numeric.html#a1841c25bb2f4bc5897d5b955f8a804ab">00298</a>     <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="namespaceambient_1_1numeric.html#acab1a850f96d50722586b8216650d555">copy_block_s</a>(<span class="keyword">const</span> <a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles&lt;Matrix&gt;</a>&amp; in, <span class="keywordtype">size_t</span> ii, <span class="keywordtype">size_t</span> ij,
<a name="l00299"></a>00299                              <a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles&lt;Matrix&gt;</a>&amp; out, <span class="keywordtype">size_t</span> oi, <span class="keywordtype">size_t</span> oj, 
<a name="l00300"></a>00300                              <span class="keyword">const</span> <a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles&lt;Matrix&gt;</a>&amp; alfa, <span class="keywordtype">size_t</span> ai, <span class="keywordtype">size_t</span> aj,
<a name="l00301"></a>00301                              <span class="keywordtype">size_t</span> m, <span class="keywordtype">size_t</span> n)
<a name="l00302"></a>00302     {
<a name="l00303"></a>00303         <span class="keyword">const</span> Matrix&amp; factor = alfa.<a class="code" href="classambient_1_1numeric_1_1tiles.html#a3f72c967ae50932204693bbb0720f07b">locate</a>(ai, aj); 
<a name="l00304"></a>00304         ai %= <a class="code" href="ambient_8hpp.html#a4c631df560c1ac2dd208c0cb9ff72a4c">AMBIENT_IB</a>; aj %= <a class="code" href="ambient_8hpp.html#a4c631df560c1ac2dd208c0cb9ff72a4c">AMBIENT_IB</a>;
<a name="l00305"></a>00305         <span class="keywordflow">for</span>(<a class="code" href="classambient_1_1numeric_1_1cross__iterator.html">cross_iterator</a> row(oi,ii,m); !row.end(); ++row)
<a name="l00306"></a>00306         <span class="keywordflow">for</span>(<a class="code" href="classambient_1_1numeric_1_1cross__iterator.html">cross_iterator</a> col(oj,ij,n); !col.end(); ++col)
<a name="l00307"></a>00307         <a class="code" href="namespaceambient_1_1numeric.html#acab1a850f96d50722586b8216650d555">copy_block_s</a>(in.<a class="code" href="classambient_1_1numeric_1_1tiles.html#a3f72c967ae50932204693bbb0720f07b">locate</a>(row.second, col.second), row.second%<a class="code" href="ambient_8hpp.html#a4c631df560c1ac2dd208c0cb9ff72a4c">AMBIENT_IB</a>, col.second%<a class="code" href="ambient_8hpp.html#a4c631df560c1ac2dd208c0cb9ff72a4c">AMBIENT_IB</a>,
<a name="l00308"></a>00308                      out.<a class="code" href="classambient_1_1numeric_1_1tiles.html#a3f72c967ae50932204693bbb0720f07b">locate</a>(row.first, col.first), row.first%<a class="code" href="ambient_8hpp.html#a4c631df560c1ac2dd208c0cb9ff72a4c">AMBIENT_IB</a>, col.first%<a class="code" href="ambient_8hpp.html#a4c631df560c1ac2dd208c0cb9ff72a4c">AMBIENT_IB</a>, 
<a name="l00309"></a>00309                      factor, ai, aj, row.step, col.step);
<a name="l00310"></a>00310     }
<a name="l00311"></a>00311 
<a name="l00312"></a>00312     <span class="keyword">template</span>&lt;<span class="keyword">class</span> Matrix, <span class="keyword">class</span> MatrixB, <span class="keyword">class</span> MatrixC&gt;
<a name="l00313"></a><a class="code" href="namespaceambient_1_1numeric.html#a2571182ac47866e3d6402b5c3f6d6b6c">00313</a>     <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="namespaceambient_1_1numeric.html#a08fc5f82a160bb6bb31cd4b3f97058da">copy_block_sa</a>(<span class="keyword">const</span> <a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles&lt;Matrix&gt;</a>&amp; in, <span class="keywordtype">size_t</span> ii, <span class="keywordtype">size_t</span> ij,
<a name="l00314"></a>00314                               <a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles&lt;MatrixB&gt;</a>&amp; out, <span class="keywordtype">size_t</span> oi, <span class="keywordtype">size_t</span> oj, 
<a name="l00315"></a>00315                               <span class="keyword">const</span> <a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles&lt;MatrixC&gt;</a>&amp; alfa, <span class="keywordtype">size_t</span> ai, <span class="keywordtype">size_t</span> aj,
<a name="l00316"></a>00316                               <span class="keywordtype">size_t</span> m, <span class="keywordtype">size_t</span> n, 
<a name="l00317"></a>00317                               <a class="code" href="diagonal__matrix_8hpp.html#a77d3f6a01bab89b6b730110f7809ead6">value_type</a> alfa_scale)
<a name="l00318"></a>00318     {
<a name="l00319"></a>00319         <span class="keyword">const</span> MatrixC&amp; factor = alfa.<a class="code" href="classambient_1_1numeric_1_1tiles.html#a3f72c967ae50932204693bbb0720f07b">locate</a>(ai, aj); 
<a name="l00320"></a>00320         ai %= <a class="code" href="ambient_8hpp.html#a4c631df560c1ac2dd208c0cb9ff72a4c">AMBIENT_IB</a>; aj %= <a class="code" href="ambient_8hpp.html#a4c631df560c1ac2dd208c0cb9ff72a4c">AMBIENT_IB</a>;
<a name="l00321"></a>00321         <span class="keywordflow">for</span>(<a class="code" href="classambient_1_1numeric_1_1cross__iterator.html">cross_iterator</a> row(oi,ii,m); !row.end(); ++row)
<a name="l00322"></a>00322         <span class="keywordflow">for</span>(<a class="code" href="classambient_1_1numeric_1_1cross__iterator.html">cross_iterator</a> col(oj,ij,n); !col.end(); ++col)
<a name="l00323"></a>00323         <a class="code" href="namespaceambient_1_1numeric.html#a08fc5f82a160bb6bb31cd4b3f97058da">copy_block_sa</a>(in.<a class="code" href="classambient_1_1numeric_1_1tiles.html#a3f72c967ae50932204693bbb0720f07b">locate</a>(row.second, col.second), row.second%<a class="code" href="ambient_8hpp.html#a4c631df560c1ac2dd208c0cb9ff72a4c">AMBIENT_IB</a>, col.second%<a class="code" href="ambient_8hpp.html#a4c631df560c1ac2dd208c0cb9ff72a4c">AMBIENT_IB</a>,
<a name="l00324"></a>00324                       out.<a class="code" href="classambient_1_1numeric_1_1tiles.html#a3f72c967ae50932204693bbb0720f07b">locate</a>(row.first, col.first), row.first%<a class="code" href="ambient_8hpp.html#a4c631df560c1ac2dd208c0cb9ff72a4c">AMBIENT_IB</a>, col.first%<a class="code" href="ambient_8hpp.html#a4c631df560c1ac2dd208c0cb9ff72a4c">AMBIENT_IB</a>, 
<a name="l00325"></a>00325                       factor, ai, aj, row.step, col.step, alfa_scale);
<a name="l00326"></a>00326     }
<a name="l00327"></a>00327 
<a name="l00328"></a>00328     <span class="keyword">template</span>&lt;<span class="keyword">class</span> MatrixA, <span class="keyword">class</span> MatrixB, <span class="keyword">class</span> MatrixC&gt;
<a name="l00329"></a><a class="code" href="namespaceambient_1_1numeric.html#ac290d7d68c5d40d0e0af12c332a9efdf">00329</a>     <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="namespaceambient_1_1numeric.html#a965d006c32a4faf1dda4b4305f096b4c">gemm</a>(<span class="keyword">const</span> <a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles&lt;MatrixA&gt;</a>&amp; a, <span class="keyword">const</span> <a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles&lt;MatrixB&gt;</a>&amp; b, <a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles&lt;MatrixC&gt;</a>&amp; c){
<a name="l00330"></a>00330         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; c.<a class="code" href="classambient_1_1numeric_1_1tiles.html#af345221ac22302e8b33e60c122955c9c">mt</a>; i++){
<a name="l00331"></a>00331             <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j = 0; j &lt; c.<a class="code" href="classambient_1_1numeric_1_1tiles.html#a0034807b433e5a3cd1e1ce8feccdd943">nt</a>; j++){
<a name="l00332"></a>00332                 std::vector&lt;MatrixC*&gt; ctree; ctree.reserve(a.<a class="code" href="classambient_1_1numeric_1_1tiles.html#a0034807b433e5a3cd1e1ce8feccdd943">nt</a>);
<a name="l00333"></a>00333                 ctree.push_back(&amp;c.<a class="code" href="classambient_1_1numeric_1_1tiles.html#a3354919fabbcd8b3e01700211a275d4e">tile</a>(i,j));
<a name="l00334"></a>00334                 <span class="keywordtype">size_t</span> rows = c.<a class="code" href="classambient_1_1numeric_1_1tiles.html#a3354919fabbcd8b3e01700211a275d4e">tile</a>(i,j).num_rows();
<a name="l00335"></a>00335                 <span class="keywordtype">size_t</span> cols = c.<a class="code" href="classambient_1_1numeric_1_1tiles.html#a3354919fabbcd8b3e01700211a275d4e">tile</a>(i,j).num_cols();
<a name="l00336"></a>00336                 <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k = 1; k &lt; a.<a class="code" href="classambient_1_1numeric_1_1tiles.html#a0034807b433e5a3cd1e1ce8feccdd943">nt</a>; k++) 
<a name="l00337"></a>00337                     ctree.push_back(<span class="keyword">new</span> MatrixC(rows, cols));
<a name="l00338"></a>00338                 <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k = 0; k &lt; a.<a class="code" href="classambient_1_1numeric_1_1tiles.html#a0034807b433e5a3cd1e1ce8feccdd943">nt</a>; k++){
<a name="l00339"></a>00339                     <span class="keyword">const</span> MatrixA&amp; ab = a.<a class="code" href="classambient_1_1numeric_1_1tiles.html#a3354919fabbcd8b3e01700211a275d4e">tile</a>(i, k);
<a name="l00340"></a>00340                     <span class="keyword">const</span> MatrixB&amp; bb = b.<a class="code" href="classambient_1_1numeric_1_1tiles.html#a3354919fabbcd8b3e01700211a275d4e">tile</a>(k, j);
<a name="l00341"></a>00341                     <a class="code" href="namespaceambient_1_1numeric.html#a965d006c32a4faf1dda4b4305f096b4c">gemm</a>(ab, bb, *ctree[k]);
<a name="l00342"></a>00342                 }
<a name="l00343"></a>00343                 <a class="code" href="namespaceambient.html#a844a824e26dacdf3db18239909f4c19f">ambient::reduce</a>(ctree);
<a name="l00344"></a>00344                 <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k = 1; k &lt; a.<a class="code" href="classambient_1_1numeric_1_1tiles.html#a0034807b433e5a3cd1e1ce8feccdd943">nt</a>; k++) 
<a name="l00345"></a>00345                     <span class="keyword">delete</span> ctree[k];
<a name="l00346"></a>00346             }
<a name="l00347"></a>00347         }
<a name="l00348"></a>00348     }
<a name="l00349"></a>00349 
<a name="l00350"></a>00350     <span class="keyword">template</span>&lt;<span class="keyword">class</span> MatrixA, <span class="keyword">class</span> MatrixC, <span class="keyword">typename</span> T&gt;
<a name="l00351"></a><a class="code" href="namespaceambient_1_1numeric.html#a07340ad7b6b33fe0552a1f1db2d529c5">00351</a>     <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="namespaceambient_1_1numeric.html#a965d006c32a4faf1dda4b4305f096b4c">gemm</a>(<span class="keyword">const</span> <a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles&lt;MatrixA&gt;</a>&amp; a, <span class="keyword">const</span> <a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles</a>&lt;<a class="code" href="classambient_1_1numeric_1_1diagonal__matrix.html">diagonal_matrix&lt;T&gt;</a> &gt;&amp; b, <a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles&lt;MatrixC&gt;</a>&amp; c){
<a name="l00352"></a>00352         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; c.<a class="code" href="classambient_1_1numeric_1_1tiles.html#af345221ac22302e8b33e60c122955c9c">mt</a>; i++){
<a name="l00353"></a>00353             <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j = 0; j &lt; c.<a class="code" href="classambient_1_1numeric_1_1tiles.html#a0034807b433e5a3cd1e1ce8feccdd943">nt</a>; j++){
<a name="l00354"></a>00354                 <a class="code" href="namespaceambient_1_1numeric.html#a965d006c32a4faf1dda4b4305f096b4c">gemm</a>(a.<a class="code" href="classambient_1_1numeric_1_1tiles.html#a3354919fabbcd8b3e01700211a275d4e">tile</a>(i,j), b[j], c.<a class="code" href="classambient_1_1numeric_1_1tiles.html#a3354919fabbcd8b3e01700211a275d4e">tile</a>(i,j));
<a name="l00355"></a>00355             }
<a name="l00356"></a>00356         }
<a name="l00357"></a>00357     }
<a name="l00358"></a>00358 
<a name="l00359"></a>00359     <span class="keyword">template</span>&lt;<span class="keyword">class</span> MatrixB, <span class="keyword">class</span> MatrixC, <span class="keyword">typename</span> T&gt;
<a name="l00360"></a><a class="code" href="namespaceambient_1_1numeric.html#a8a525fc78b44ec0e24e8939b4f3527d5">00360</a>     <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="namespaceambient_1_1numeric.html#a965d006c32a4faf1dda4b4305f096b4c">gemm</a>(<span class="keyword">const</span> <a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles</a>&lt;<a class="code" href="classambient_1_1numeric_1_1diagonal__matrix.html">diagonal_matrix&lt;T&gt;</a> &gt;&amp; a, <span class="keyword">const</span> <a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles&lt;MatrixB&gt;</a>&amp; b, <a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles&lt;MatrixC&gt;</a>&amp; c){
<a name="l00361"></a>00361         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; c.<a class="code" href="classambient_1_1numeric_1_1tiles.html#af345221ac22302e8b33e60c122955c9c">mt</a>; i++){
<a name="l00362"></a>00362             <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j = 0; j &lt; c.<a class="code" href="classambient_1_1numeric_1_1tiles.html#a0034807b433e5a3cd1e1ce8feccdd943">nt</a>; j++){
<a name="l00363"></a>00363                 <a class="code" href="namespaceambient_1_1numeric.html#a965d006c32a4faf1dda4b4305f096b4c">gemm</a>(a[i], b.<a class="code" href="classambient_1_1numeric_1_1tiles.html#a3354919fabbcd8b3e01700211a275d4e">tile</a>(i,j), c.<a class="code" href="classambient_1_1numeric_1_1tiles.html#a3354919fabbcd8b3e01700211a275d4e">tile</a>(i,j));
<a name="l00364"></a>00364             }
<a name="l00365"></a>00365         }
<a name="l00366"></a>00366     }
<a name="l00367"></a>00367 
<a name="l00368"></a>00368     <span class="keyword">template</span>&lt;<span class="keyword">class</span> Matrix, <span class="keyword">class</span> DiagonalMatrix&gt;
<a name="l00369"></a><a class="code" href="namespaceambient_1_1numeric.html#adea6703cd70b4f28ea671e7c899d8d2d">00369</a>     <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="namespaceambient_1_1numeric.html#acf15ba6f57f4e7e470bc361166a7f7a9">svd</a>(<a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles&lt;Matrix&gt;</a> a, <a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles&lt;Matrix&gt;</a>&amp; u, <a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles&lt;Matrix&gt;</a>&amp; v, <a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles&lt;DiagonalMatrix&gt;</a>&amp; s){
<a name="l00370"></a>00370         <span class="keywordtype">size_t</span> m = <a class="code" href="namespaceambient_1_1numeric.html#a0fecbb64cb533f5bb0dd8e6522b2161e">num_rows</a>(a);
<a name="l00371"></a>00371         <span class="keywordtype">size_t</span> n = <a class="code" href="namespaceambient_1_1numeric.html#ab3fc6c53a7c80693b666ffb7462177ba">num_cols</a>(a);
<a name="l00372"></a>00372         <span class="keywordtype">size_t</span> k = std::min(m,n);
<a name="l00373"></a>00373         <a class="code" href="namespaceambient_1_1numeric.html#a218e7d6acd73b129d3e26544cf8b6272">resize</a>(u, m, k);
<a name="l00374"></a>00374         <a class="code" href="namespaceambient_1_1numeric.html#a218e7d6acd73b129d3e26544cf8b6272">resize</a>(s, k, k);
<a name="l00375"></a>00375         <a class="code" href="namespaceambient_1_1numeric.html#a218e7d6acd73b129d3e26544cf8b6272">resize</a>(v, k, n);
<a name="l00376"></a>00376 
<a name="l00377"></a>00377         <a class="code" href="namespaceambient_1_1numeric.html#aad8a5ccb79ca8d0fa12304fe45e50f0d">merge</a>(a); <a class="code" href="namespaceambient_1_1numeric.html#aad8a5ccb79ca8d0fa12304fe45e50f0d">merge</a>(u); <a class="code" href="namespaceambient_1_1numeric.html#aad8a5ccb79ca8d0fa12304fe45e50f0d">merge</a>(v); <a class="code" href="namespaceambient_1_1numeric.html#aad8a5ccb79ca8d0fa12304fe45e50f0d">merge</a>(s);
<a name="l00378"></a>00378         <a class="code" href="namespaceambient_1_1numeric.html#acf15ba6f57f4e7e470bc361166a7f7a9">svd</a>(a[0], u[0], v[0], s[0]);
<a name="l00379"></a>00379         <a class="code" href="namespaceambient_1_1numeric.html#a6873c8866af05cc4580a86aab25593fb">split</a>(u); <a class="code" href="namespaceambient_1_1numeric.html#a6873c8866af05cc4580a86aab25593fb">split</a>(v); <a class="code" href="namespaceambient_1_1numeric.html#a6873c8866af05cc4580a86aab25593fb">split</a>(s);
<a name="l00380"></a>00380     }
<a name="l00381"></a>00381 
<a name="l00382"></a>00382     <span class="keyword">template</span>&lt;<span class="keyword">class</span> Matrix, <span class="keyword">class</span> DiagonalMatrix&gt;
<a name="l00383"></a><a class="code" href="namespaceambient_1_1numeric.html#a00f82aa26e1bc632c247c5489af0f34f">00383</a>     <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="namespaceambient_1_1numeric.html#a00f82aa26e1bc632c247c5489af0f34f">svd_merged</a>(<a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles&lt;Matrix&gt;</a> a, <a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles&lt;Matrix&gt;</a>&amp; u, <a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles&lt;Matrix&gt;</a>&amp; v, <a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles&lt;DiagonalMatrix&gt;</a>&amp; s){
<a name="l00384"></a>00384         <a class="code" href="namespaceambient_1_1numeric.html#aad8a5ccb79ca8d0fa12304fe45e50f0d">merge</a>(a); <a class="code" href="namespaceambient_1_1numeric.html#aad8a5ccb79ca8d0fa12304fe45e50f0d">merge</a>(u); <a class="code" href="namespaceambient_1_1numeric.html#aad8a5ccb79ca8d0fa12304fe45e50f0d">merge</a>(v); <a class="code" href="namespaceambient_1_1numeric.html#aad8a5ccb79ca8d0fa12304fe45e50f0d">merge</a>(s);
<a name="l00385"></a>00385         <a class="code" href="namespaceambient_1_1numeric.html#acf15ba6f57f4e7e470bc361166a7f7a9">svd</a>(a[0], u[0], v[0], s[0]);
<a name="l00386"></a>00386     }
<a name="l00387"></a>00387 
<a name="l00388"></a>00388     <span class="keyword">template</span>&lt;<span class="keyword">class</span> Matrix, <span class="keyword">class</span> DiagonalMatrix&gt;
<a name="l00389"></a><a class="code" href="namespaceambient_1_1numeric.html#a450b464f07fbc195be31edbdb35a580d">00389</a>     <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="namespaceambient_1_1numeric.html#a61a9ca3315a26fc6d0b6dd66e97e026e">heev</a>(<a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles&lt;Matrix&gt;</a> a, <a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles&lt;Matrix&gt;</a>&amp; evecs, <a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles&lt;DiagonalMatrix&gt;</a>&amp; evals){
<a name="l00390"></a>00390         <a class="code" href="namespaceambient_1_1numeric.html#aad8a5ccb79ca8d0fa12304fe45e50f0d">merge</a>(a); <a class="code" href="namespaceambient_1_1numeric.html#aad8a5ccb79ca8d0fa12304fe45e50f0d">merge</a>(evecs); <a class="code" href="namespaceambient_1_1numeric.html#aad8a5ccb79ca8d0fa12304fe45e50f0d">merge</a>(evals);
<a name="l00391"></a>00391         <a class="code" href="namespaceambient_1_1numeric.html#a61a9ca3315a26fc6d0b6dd66e97e026e">heev</a>(a[0], evecs[0], evals[0]);
<a name="l00392"></a>00392         <a class="code" href="namespaceambient_1_1numeric.html#a6873c8866af05cc4580a86aab25593fb">split</a>(evecs); <a class="code" href="namespaceambient_1_1numeric.html#a6873c8866af05cc4580a86aab25593fb">split</a>(evals);
<a name="l00393"></a>00393     }
<a name="l00394"></a>00394 
<a name="l00395"></a>00395     <span class="keyword">template</span>&lt;<span class="keyword">class</span> Matrix, <span class="keyword">class</span> DiagonalMatrix&gt;
<a name="l00396"></a><a class="code" href="namespaceambient_1_1numeric.html#a33907ebb041819d667f5ec56cf75be89">00396</a>     <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="namespaceambient_1_1numeric.html#a33907ebb041819d667f5ec56cf75be89">heev_merged</a>(<a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles&lt;Matrix&gt;</a> a, <a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles&lt;Matrix&gt;</a>&amp; evecs, <a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles&lt;DiagonalMatrix&gt;</a>&amp; evals){
<a name="l00397"></a>00397         <a class="code" href="namespaceambient_1_1numeric.html#aad8a5ccb79ca8d0fa12304fe45e50f0d">merge</a>(a); <a class="code" href="namespaceambient_1_1numeric.html#aad8a5ccb79ca8d0fa12304fe45e50f0d">merge</a>(evecs); <a class="code" href="namespaceambient_1_1numeric.html#aad8a5ccb79ca8d0fa12304fe45e50f0d">merge</a>(evals);
<a name="l00398"></a>00398         <a class="code" href="namespaceambient_1_1numeric.html#a61a9ca3315a26fc6d0b6dd66e97e026e">heev</a>(a[0], evecs[0], evals[0]);
<a name="l00399"></a>00399     }
<a name="l00400"></a>00400 
<a name="l00401"></a>00401     <span class="keyword">template</span>&lt;<span class="keyword">class</span> Matrix, <span class="keyword">class</span> DiagonalMatrix&gt;
<a name="l00402"></a><a class="code" href="namespaceambient_1_1numeric.html#a720ff801a60e322d9a163a0d126bb4eb">00402</a>     <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="namespaceambient_1_1numeric.html#aad9bfba49c10b6fd631124578f4e21af">syev</a>(<a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles&lt;Matrix&gt;</a> a, <a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles&lt;Matrix&gt;</a>&amp; evecs, <a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles&lt;DiagonalMatrix&gt;</a>&amp; evals){
<a name="l00403"></a>00403         <a class="code" href="namespaceambient_1_1numeric.html#aad8a5ccb79ca8d0fa12304fe45e50f0d">merge</a>(a); <a class="code" href="namespaceambient_1_1numeric.html#aad8a5ccb79ca8d0fa12304fe45e50f0d">merge</a>(evecs); <a class="code" href="namespaceambient_1_1numeric.html#aad8a5ccb79ca8d0fa12304fe45e50f0d">merge</a>(evals);
<a name="l00404"></a>00404         <a class="code" href="namespaceambient_1_1numeric.html#a61a9ca3315a26fc6d0b6dd66e97e026e">heev</a>(a[0], evecs[0], evals[0]);
<a name="l00405"></a>00405         <a class="code" href="namespaceambient_1_1numeric.html#a6873c8866af05cc4580a86aab25593fb">split</a>(evecs); <a class="code" href="namespaceambient_1_1numeric.html#a6873c8866af05cc4580a86aab25593fb">split</a>(evals);
<a name="l00406"></a>00406     }
<a name="l00407"></a>00407                 
<a name="l00408"></a>00408     <span class="keyword">template</span>&lt;<span class="keyword">class</span> Matrix&gt;
<a name="l00409"></a><a class="code" href="namespaceambient_1_1numeric.html#a328529561184bcf84ad8ec2d2b92588e">00409</a>     <span class="keywordtype">void</span> <a class="code" href="namespaceambient_1_1numeric.html#a328529561184bcf84ad8ec2d2b92588e">orgqr</a>(<span class="keyword">const</span> <a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles&lt;Matrix&gt;</a>&amp;&amp; a, <a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles&lt;Matrix&gt;</a>&amp;&amp; q, <span class="keyword">const</span> <a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles&lt;Matrix&gt;</a>&amp;&amp; t){
<a name="l00410"></a>00410         <span class="keywordtype">int</span> k, m, n;
<a name="l00411"></a>00411 
<a name="l00412"></a>00412         <span class="keywordflow">for</span>(k = std::min(a.mt, a.nt)-1; k &gt;= 0; k--){
<a name="l00413"></a>00413             <span class="keywordflow">for</span>(m = q.mt - 1; m &gt; k; m--)
<a name="l00414"></a>00414                 <span class="keywordflow">for</span>(n = 0; n &lt; q.nt; n++)
<a name="l00415"></a>00415                     tsmqr&lt;PlasmaNoTrans&gt;(a.tile(m, k).num_cols(), q.tile(k, n), q.tile(m, n), a.tile(m, k), t.tile(m, k));
<a name="l00416"></a>00416             
<a name="l00417"></a>00417             <span class="keywordflow">for</span>(n = 0; n &lt; q.nt; n++)
<a name="l00418"></a>00418                 ormqr&lt;PlasmaNoTrans&gt;(std::min(a.tile(k,k).num_rows(), a.tile(k,k).num_cols()), a.tile(k, k), t.tile(k, k), q.tile(k, n));
<a name="l00419"></a>00419         }
<a name="l00420"></a>00420     }
<a name="l00421"></a>00421 
<a name="l00422"></a>00422     <span class="keyword">template</span>&lt;<span class="keyword">class</span> Matrix&gt;
<a name="l00423"></a><a class="code" href="namespaceambient_1_1numeric.html#a812658f1faad79ad85f6bfba77b4aa9d">00423</a>     <span class="keywordtype">void</span> <a class="code" href="namespaceambient_1_1numeric.html#a812658f1faad79ad85f6bfba77b4aa9d">orglq</a>(<span class="keyword">const</span> <a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles&lt;Matrix&gt;</a>&amp;&amp; a, <a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles&lt;Matrix&gt;</a>&amp;&amp; q, <span class="keyword">const</span> <a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles&lt;Matrix&gt;</a>&amp;&amp; t){
<a name="l00424"></a>00424         <span class="keywordtype">int</span> k, m, n;
<a name="l00425"></a>00425 
<a name="l00426"></a>00426         <span class="keywordflow">for</span>(k = std::min(a.mt, a.nt)-1; k &gt;= 0; k--){
<a name="l00427"></a>00427             <span class="keywordflow">for</span>(n = q.nt-1; n &gt; k; n--)
<a name="l00428"></a>00428                 <span class="keywordflow">for</span>(m = 0; m &lt; q.mt; m++)
<a name="l00429"></a>00429                     tsmlq&lt;PlasmaNoTrans&gt;(a.tile(k, n).num_rows(), q.tile(m, k), q.tile(m, n), a.tile(k, n), t.tile(k, n));
<a name="l00430"></a>00430         
<a name="l00431"></a>00431             <span class="keywordflow">for</span>(m = 0; m &lt; q.mt; m++)
<a name="l00432"></a>00432                 ormlq&lt;PlasmaNoTrans&gt;(std::min(a.tile(k,k).num_rows(), a.tile(k,k).num_cols()), a.tile(k, k), t.tile(k, k), q.tile(m, k));
<a name="l00433"></a>00433         }
<a name="l00434"></a>00434     }
<a name="l00435"></a>00435 
<a name="l00436"></a>00436     <span class="keyword">template</span>&lt;<span class="keyword">class</span> Matrix&gt;
<a name="l00437"></a><a class="code" href="namespaceambient_1_1numeric.html#a036928ee3db64fab82982c479115aa42">00437</a>     <span class="keywordtype">void</span> <a class="code" href="namespaceambient_1_1numeric.html#adfe351598a4c7e75b66c5ff60cb54827">ormqr</a>(<a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles&lt;Matrix&gt;</a>&amp;&amp; a, <a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles&lt;Matrix&gt;</a>&amp;&amp; b, <a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles&lt;Matrix&gt;</a>&amp;&amp; t){
<a name="l00438"></a>00438         <span class="keywordtype">int</span> k, m, n;
<a name="l00439"></a>00439     
<a name="l00440"></a>00440        <span class="comment">// PlasmaLeft / trans_helper&lt;value_type&gt;::PlasmaTransValue</span>
<a name="l00441"></a>00441         <span class="keywordflow">for</span>(k = 0; k &lt; std::min(a.mt, a.nt); k++){
<a name="l00442"></a>00442             <span class="keywordtype">size_t</span> kmin = std::min(a.tile(k,k).num_rows(), a.tile(k,k).num_cols());
<a name="l00443"></a>00443             <span class="keywordflow">for</span>(n = 0; n &lt; b.nt; n++){
<a name="l00444"></a>00444                 ormqr&lt;trans_helper&lt;value_type&gt;::PlasmaTransValue&gt;(kmin, a.tile(k, k), t.tile(k, k), b.tile(k, n));
<a name="l00445"></a>00445             }
<a name="l00446"></a>00446             <span class="keywordflow">for</span>(m = k+1; m &lt; b.mt; m++){
<a name="l00447"></a>00447                 <span class="keywordflow">for</span>(n = 0; n &lt; b.nt; n++)
<a name="l00448"></a>00448                     <a class="code" href="namespaceambient_1_1numeric.html#abd37401913caa9d074fd9cd704b207a1">tsmqr</a>&lt;<a class="code" href="structtrans__helper.html">trans_helper&lt;value_type&gt;::PlasmaTransValue</a>&gt;(kmin, b.tile(k, n), b.tile(m, n), a.tile(m, k), t.tile(m, k));
<a name="l00449"></a>00449             }
<a name="l00450"></a>00450         }
<a name="l00451"></a>00451     }
<a name="l00452"></a>00452 
<a name="l00453"></a>00453     <span class="keyword">template</span>&lt;<span class="keyword">class</span> Matrix&gt;
<a name="l00454"></a><a class="code" href="namespaceambient_1_1numeric.html#a61279831f043d92bb839037e4fb908ea">00454</a>     <span class="keywordtype">void</span> <a class="code" href="namespaceambient_1_1numeric.html#a6e83d4f89011f58fb2e5d7eab2ab09f8">ormlq</a>(<a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles&lt;Matrix&gt;</a>&amp;&amp; a, <a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles&lt;Matrix&gt;</a>&amp;&amp; b, <a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles&lt;Matrix&gt;</a>&amp;&amp; t){
<a name="l00455"></a>00455         <span class="keywordtype">int</span> k, m, n;
<a name="l00456"></a>00456         
<a name="l00457"></a>00457         <span class="keywordflow">for</span>(k = 0; k &lt; std::min(a.mt, a.nt); k++){
<a name="l00458"></a>00458             <span class="keywordtype">size_t</span> kmin = std::min(a.tile(k,k).num_rows(), a.tile(k,k).num_cols());
<a name="l00459"></a>00459             <span class="keywordflow">for</span>(m = 0; m &lt; b.mt; m++){
<a name="l00460"></a>00460                 ormlq&lt;trans_helper&lt;value_type&gt;::PlasmaTransValue&gt;(kmin, a.tile(k, k), t.tile(k, k), b.tile(m, k));
<a name="l00461"></a>00461             }
<a name="l00462"></a>00462             <span class="keywordflow">for</span>(n = k+1; n &lt; b.nt; n++){
<a name="l00463"></a>00463                 <span class="keywordflow">for</span>(m = 0; m &lt; b.mt; m++){
<a name="l00464"></a>00464                     tsmlq&lt;trans_helper&lt;value_type&gt;::PlasmaTransValue&gt;(kmin, b.tile(m, k), b.tile(m, n), a.tile(k, n), t.tile(k, n));
<a name="l00465"></a>00465                 }
<a name="l00466"></a>00466             }
<a name="l00467"></a>00467         }
<a name="l00468"></a>00468     }
<a name="l00469"></a>00469 
<a name="l00470"></a>00470     <span class="keyword">template</span>&lt;<span class="keyword">class</span> Matrix&gt;
<a name="l00471"></a><a class="code" href="namespaceambient_1_1numeric.html#ae7dbff0f01a9fcd4d9fde00cc2f5b8d5">00471</a>     <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="namespaceambient_1_1numeric.html#ae7dbff0f01a9fcd4d9fde00cc2f5b8d5">qr</a>(<a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles&lt;Matrix&gt;</a>&amp;&amp; a, <a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles&lt;Matrix&gt;</a>&amp;&amp; t){
<a name="l00472"></a>00472         <span class="keywordtype">int</span> k, m, n;
<a name="l00473"></a>00473         
<a name="l00474"></a>00474         <span class="keywordflow">for</span>(k = 0; k &lt; std::min(a.mt, a.nt); k++){
<a name="l00475"></a>00475             <a class="code" href="namespaceambient_1_1numeric.html#a46687b1c3359d0be1980b281b9e970ad">geqrt</a>(a.tile(k, k), t.tile(k, k));
<a name="l00476"></a>00476         
<a name="l00477"></a>00477             <span class="keywordflow">for</span>(n = k+1; n &lt; a.nt; n++)
<a name="l00478"></a>00478                 <a class="code" href="namespaceambient_1_1numeric.html#adfe351598a4c7e75b66c5ff60cb54827">ormqr</a>&lt;<a class="code" href="structtrans__helper.html">trans_helper&lt;value_type&gt;::PlasmaTransValue</a>&gt;(a.tile(k,n).num_rows(), a.tile(k, k), t.tile(k, k), a.tile(k, n));
<a name="l00479"></a>00479             
<a name="l00480"></a>00480             <span class="keywordflow">for</span>(m = k+1; m &lt; a.mt; m++){
<a name="l00481"></a>00481                 <a class="code" href="namespaceambient_1_1numeric.html#ac242d9c2e23ce6a7fe68cec7e4a517e8">tsqrt</a>(a.tile(k, k), a.tile(m, k), t.tile(m, k));
<a name="l00482"></a>00482         
<a name="l00483"></a>00483                 <span class="keywordflow">for</span>(n = k+1; n &lt; a.nt; n++)
<a name="l00484"></a>00484                     <a class="code" href="namespaceambient_1_1numeric.html#abd37401913caa9d074fd9cd704b207a1">tsmqr</a>&lt;<a class="code" href="structtrans__helper.html">trans_helper&lt;value_type&gt;::PlasmaTransValue</a>&gt;(<a class="code" href="ambient_8hpp.html#a4c631df560c1ac2dd208c0cb9ff72a4c">AMBIENT_IB</a>, a.tile(k, n), a.tile(m, n), a.tile(m, k), t.tile(m, k));
<a name="l00485"></a>00485             }
<a name="l00486"></a>00486         }
<a name="l00487"></a>00487     }
<a name="l00488"></a>00488 
<a name="l00489"></a>00489 
<a name="l00490"></a>00490     <span class="keyword">template</span>&lt;<span class="keyword">class</span> Matrix&gt;
<a name="l00491"></a><a class="code" href="namespaceambient_1_1numeric.html#ade58fd45f2ae7b867c22b1fa9a777c4f">00491</a>     <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="namespaceambient_1_1numeric.html#ae7dbff0f01a9fcd4d9fde00cc2f5b8d5">qr</a>(<a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles&lt;Matrix&gt;</a> a, <a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles&lt;Matrix&gt;</a>&amp; q, <a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles&lt;Matrix&gt;</a>&amp; r){
<a name="l00492"></a>00492         <span class="keywordtype">int</span> am = <a class="code" href="namespaceambient_1_1numeric.html#a0fecbb64cb533f5bb0dd8e6522b2161e">num_rows</a>(a);
<a name="l00493"></a>00493         <span class="keywordtype">int</span> an = <a class="code" href="namespaceambient_1_1numeric.html#ab3fc6c53a7c80693b666ffb7462177ba">num_cols</a>(a);
<a name="l00494"></a>00494         <span class="keywordtype">int</span> ak = std::min(am,an);
<a name="l00495"></a>00495         <a class="code" href="namespaceambient_1_1numeric.html#a218e7d6acd73b129d3e26544cf8b6272">resize</a>(q, am, an);
<a name="l00496"></a>00496         <a class="code" href="namespaceambient_1_1numeric.html#a218e7d6acd73b129d3e26544cf8b6272">resize</a>(r, ak, an);
<a name="l00497"></a>00497         
<a name="l00498"></a>00498         <a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles&lt;Matrix&gt;</a> t(a.<a class="code" href="classambient_1_1numeric_1_1tiles.html#af345221ac22302e8b33e60c122955c9c">mt</a>*<a class="code" href="ambient_8hpp.html#a4c631df560c1ac2dd208c0cb9ff72a4c">AMBIENT_IB</a>, a.<a class="code" href="classambient_1_1numeric_1_1tiles.html#a0034807b433e5a3cd1e1ce8feccdd943">nt</a>*<a class="code" href="ambient_8hpp.html#a4c631df560c1ac2dd208c0cb9ff72a4c">AMBIENT_IB</a>);
<a name="l00499"></a>00499         <a class="code" href="namespaceambient_1_1numeric.html#ae7dbff0f01a9fcd4d9fde00cc2f5b8d5">qr</a>(std::move(a), std::move(t));
<a name="l00500"></a>00500         
<a name="l00501"></a>00501         <span class="comment">// restoring R from A //</span>
<a name="l00502"></a>00502         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j = 0; j &lt; a.<a class="code" href="classambient_1_1numeric_1_1tiles.html#a0034807b433e5a3cd1e1ce8feccdd943">nt</a>; j++)
<a name="l00503"></a>00503             <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; j &amp;&amp; i &lt; std::min(a.<a class="code" href="classambient_1_1numeric_1_1tiles.html#af345221ac22302e8b33e60c122955c9c">mt</a>, a.<a class="code" href="classambient_1_1numeric_1_1tiles.html#a0034807b433e5a3cd1e1ce8feccdd943">nt</a>); i++)
<a name="l00504"></a>00504                 <a class="code" href="namespaceambient_1_1numeric.html#ac0459310d77eee16dffae3cbbdd0c381">copy</a>(a.<a class="code" href="classambient_1_1numeric_1_1tiles.html#a3354919fabbcd8b3e01700211a275d4e">tile</a>(i,j), r.<a class="code" href="classambient_1_1numeric_1_1tiles.html#a3354919fabbcd8b3e01700211a275d4e">tile</a>(i,j));
<a name="l00505"></a>00505         
<a name="l00506"></a>00506         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k = 0; k &lt; std::min(a.<a class="code" href="classambient_1_1numeric_1_1tiles.html#af345221ac22302e8b33e60c122955c9c">mt</a>, a.<a class="code" href="classambient_1_1numeric_1_1tiles.html#a0034807b433e5a3cd1e1ce8feccdd943">nt</a>); k++)
<a name="l00507"></a>00507             <a class="code" href="namespaceambient_1_1numeric.html#a686f10a40d1ff1b2bd52740ec73f2b11">copy_rt</a>(a.<a class="code" href="classambient_1_1numeric_1_1tiles.html#a3354919fabbcd8b3e01700211a275d4e">tile</a>(k,k), r.<a class="code" href="classambient_1_1numeric_1_1tiles.html#a3354919fabbcd8b3e01700211a275d4e">tile</a>(k,k));
<a name="l00508"></a>00508         
<a name="l00509"></a>00509         <span class="comment">// restoring Q from T //</span>
<a name="l00510"></a>00510         <span class="comment">// do we need to memset Q first?</span>
<a name="l00511"></a>00511         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; std::min(a.<a class="code" href="classambient_1_1numeric_1_1tiles.html#af345221ac22302e8b33e60c122955c9c">mt</a>, a.<a class="code" href="classambient_1_1numeric_1_1tiles.html#a0034807b433e5a3cd1e1ce8feccdd943">nt</a>); i++)
<a name="l00512"></a>00512             <a class="code" href="namespaceambient_1_1numeric.html#ae72a4f209db8a07d5cac1824753e39c6">fill_identity</a>(q.<a class="code" href="classambient_1_1numeric_1_1tiles.html#a3354919fabbcd8b3e01700211a275d4e">tile</a>(i,i));
<a name="l00513"></a>00513        
<a name="l00514"></a>00514         <a class="code" href="namespaceambient_1_1numeric.html#a328529561184bcf84ad8ec2d2b92588e">orgqr</a>(std::move(a), std::move(q), std::move(t)); 
<a name="l00515"></a>00515         <a class="code" href="namespaceambient_1_1numeric.html#a218e7d6acd73b129d3e26544cf8b6272">resize</a>(q, am, ak);
<a name="l00516"></a>00516     }
<a name="l00517"></a>00517 
<a name="l00518"></a>00518     <span class="keyword">template</span>&lt;<span class="keyword">class</span> Matrix&gt;
<a name="l00519"></a><a class="code" href="namespaceambient_1_1numeric.html#a2bbb2367a50812e03e49d490c00245b7">00519</a>     <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="namespaceambient_1_1numeric.html#a2bbb2367a50812e03e49d490c00245b7">lq</a>(<a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles&lt;Matrix&gt;</a>&amp;&amp; a, <a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles&lt;Matrix&gt;</a>&amp;&amp; t){
<a name="l00520"></a>00520         <span class="keywordtype">int</span> k, m, n;
<a name="l00521"></a>00521         
<a name="l00522"></a>00522         <span class="keywordflow">for</span>(k = 0; k &lt; std::min(a.mt, a.nt); k++) {
<a name="l00523"></a>00523             <a class="code" href="namespaceambient_1_1numeric.html#a50588618562b5bb4d4f8ea88af714d85">gelqt</a>(a.tile(k, k), t.tile(k, k));
<a name="l00524"></a>00524         
<a name="l00525"></a>00525             <span class="keywordflow">for</span>(m = k+1; m &lt; a.mt; m++)
<a name="l00526"></a>00526                 <a class="code" href="namespaceambient_1_1numeric.html#a6e83d4f89011f58fb2e5d7eab2ab09f8">ormlq</a>&lt;<a class="code" href="structtrans__helper.html">trans_helper&lt;value_type&gt;::PlasmaTransValue</a>&gt;(a.tile(m, k).num_cols(), a.tile(k, k), t.tile(k, k), a.tile(m, k));
<a name="l00527"></a>00527         
<a name="l00528"></a>00528             <span class="keywordflow">for</span>(n = k+1; n &lt; a.nt; n++){
<a name="l00529"></a>00529                 <a class="code" href="namespaceambient_1_1numeric.html#ac1b3bf84aea91e9ca76ce12651590e27">tslqt</a>(a.tile(k, k), a.tile(k, n), t.tile(k, n));
<a name="l00530"></a>00530         
<a name="l00531"></a>00531                 <span class="keywordflow">for</span>(m = k+1; m &lt; a.mt; m++)
<a name="l00532"></a>00532                     <a class="code" href="namespaceambient_1_1numeric.html#a71e7556c0e44892e7bb93262cdd4a12f">tsmlq</a>&lt;<a class="code" href="structtrans__helper.html">trans_helper&lt;value_type&gt;::PlasmaTransValue</a>&gt;(<a class="code" href="ambient_8hpp.html#a4c631df560c1ac2dd208c0cb9ff72a4c">AMBIENT_IB</a>, a.tile(m, k), a.tile(m, n), a.tile(k, n), t.tile(k, n));
<a name="l00533"></a>00533             }
<a name="l00534"></a>00534         }
<a name="l00535"></a>00535     }
<a name="l00536"></a>00536 
<a name="l00537"></a>00537     <span class="keyword">template</span>&lt;<span class="keyword">class</span> Matrix&gt;
<a name="l00538"></a><a class="code" href="namespaceambient_1_1numeric.html#aec281209a9fd1d74e03207c13b8c5010">00538</a>     <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="namespaceambient_1_1numeric.html#a2bbb2367a50812e03e49d490c00245b7">lq</a>(<a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles&lt;Matrix&gt;</a> a, <a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles&lt;Matrix&gt;</a>&amp; l, <a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles&lt;Matrix&gt;</a>&amp; q){
<a name="l00539"></a>00539         <span class="keywordtype">int</span> am = <a class="code" href="namespaceambient_1_1numeric.html#a0fecbb64cb533f5bb0dd8e6522b2161e">num_rows</a>(a);
<a name="l00540"></a>00540         <span class="keywordtype">int</span> an = <a class="code" href="namespaceambient_1_1numeric.html#ab3fc6c53a7c80693b666ffb7462177ba">num_cols</a>(a);
<a name="l00541"></a>00541         <span class="keywordtype">int</span> ak = std::min(am,an);
<a name="l00542"></a>00542         <a class="code" href="namespaceambient_1_1numeric.html#a218e7d6acd73b129d3e26544cf8b6272">resize</a>(l, am, ak);
<a name="l00543"></a>00543         <a class="code" href="namespaceambient_1_1numeric.html#a218e7d6acd73b129d3e26544cf8b6272">resize</a>(q, am, an); <span class="comment">// instead of ak</span>
<a name="l00544"></a>00544         
<a name="l00545"></a>00545         <a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles&lt;Matrix&gt;</a> t(a.<a class="code" href="classambient_1_1numeric_1_1tiles.html#af345221ac22302e8b33e60c122955c9c">mt</a>*<a class="code" href="ambient_8hpp.html#a4c631df560c1ac2dd208c0cb9ff72a4c">AMBIENT_IB</a>, a.<a class="code" href="classambient_1_1numeric_1_1tiles.html#a0034807b433e5a3cd1e1ce8feccdd943">nt</a>*<a class="code" href="ambient_8hpp.html#a4c631df560c1ac2dd208c0cb9ff72a4c">AMBIENT_IB</a>);
<a name="l00546"></a>00546         <a class="code" href="namespaceambient_1_1numeric.html#a2bbb2367a50812e03e49d490c00245b7">lq</a>(std::move(a), std::move(t));
<a name="l00547"></a>00547         
<a name="l00548"></a>00548         <span class="comment">// restoring L from A //</span>
<a name="l00549"></a>00549         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j = 0; j &lt; std::min(a.<a class="code" href="classambient_1_1numeric_1_1tiles.html#af345221ac22302e8b33e60c122955c9c">mt</a>, a.<a class="code" href="classambient_1_1numeric_1_1tiles.html#a0034807b433e5a3cd1e1ce8feccdd943">nt</a>); ++j)
<a name="l00550"></a>00550         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = j+1; i &lt; a.<a class="code" href="classambient_1_1numeric_1_1tiles.html#af345221ac22302e8b33e60c122955c9c">mt</a>; ++i)
<a name="l00551"></a>00551             <a class="code" href="namespaceambient_1_1numeric.html#ac0459310d77eee16dffae3cbbdd0c381">copy</a>(a.<a class="code" href="classambient_1_1numeric_1_1tiles.html#a3354919fabbcd8b3e01700211a275d4e">tile</a>(i,j), l.<a class="code" href="classambient_1_1numeric_1_1tiles.html#a3354919fabbcd8b3e01700211a275d4e">tile</a>(i,j));
<a name="l00552"></a>00552         
<a name="l00553"></a>00553         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k = 0; k &lt; std::min(a.<a class="code" href="classambient_1_1numeric_1_1tiles.html#af345221ac22302e8b33e60c122955c9c">mt</a>, a.<a class="code" href="classambient_1_1numeric_1_1tiles.html#a0034807b433e5a3cd1e1ce8feccdd943">nt</a>); k++)
<a name="l00554"></a>00554             <a class="code" href="namespaceambient_1_1numeric.html#a52d36e39ef88fc59a3d50de5b234ac70">copy_lt</a>(a.<a class="code" href="classambient_1_1numeric_1_1tiles.html#a3354919fabbcd8b3e01700211a275d4e">tile</a>(k,k), l.<a class="code" href="classambient_1_1numeric_1_1tiles.html#a3354919fabbcd8b3e01700211a275d4e">tile</a>(k,k));
<a name="l00555"></a>00555         
<a name="l00556"></a>00556         <span class="comment">// restoring Q from T //</span>
<a name="l00557"></a>00557         <span class="comment">// do we need to memset Q first?</span>
<a name="l00558"></a>00558         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; std::min(a.<a class="code" href="classambient_1_1numeric_1_1tiles.html#af345221ac22302e8b33e60c122955c9c">mt</a>, a.<a class="code" href="classambient_1_1numeric_1_1tiles.html#a0034807b433e5a3cd1e1ce8feccdd943">nt</a>); i++)
<a name="l00559"></a>00559             <a class="code" href="namespaceambient_1_1numeric.html#ae72a4f209db8a07d5cac1824753e39c6">fill_identity</a>(q.<a class="code" href="classambient_1_1numeric_1_1tiles.html#a3354919fabbcd8b3e01700211a275d4e">tile</a>(i,i));
<a name="l00560"></a>00560        
<a name="l00561"></a>00561         <a class="code" href="namespaceambient_1_1numeric.html#a812658f1faad79ad85f6bfba77b4aa9d">orglq</a>(std::move(a), std::move(q), std::move(t)); 
<a name="l00562"></a>00562         <a class="code" href="namespaceambient_1_1numeric.html#a218e7d6acd73b129d3e26544cf8b6272">resize</a>(q, ak, an);
<a name="l00563"></a>00563     }
<a name="l00564"></a>00564 
<a name="l00565"></a>00565     <span class="keyword">template</span>&lt;<span class="keyword">class</span> Matrix&gt; 
<a name="l00566"></a><a class="code" href="namespaceambient_1_1numeric.html#a87bbafb5dab7dbaaee18d2999040ac59">00566</a>     <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="namespaceambient_1_1numeric.html#a218e7d6acd73b129d3e26544cf8b6272">resize</a>(<a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles&lt;Matrix&gt;</a>&amp; a, <span class="keywordtype">size_t</span> m, <span class="keywordtype">size_t</span> n){ 
<a name="l00567"></a>00567         <span class="keywordflow">if</span>(a.<a class="code" href="classambient_1_1numeric_1_1tiles.html#ae3864579976ac37a791a9707f02eee4c">num_rows</a>() == m &amp;&amp; a.<a class="code" href="classambient_1_1numeric_1_1tiles.html#a2a69e3e6f7af130998a8c93ac8b35339">num_cols</a>() == n) <span class="keywordflow">return</span>;
<a name="l00568"></a>00568         <a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles&lt;Matrix&gt;</a> r(m, n);
<a name="l00569"></a>00569 
<a name="l00570"></a>00570         <span class="keywordtype">int</span> mb_min = std::min(r.<a class="code" href="classambient_1_1numeric_1_1tiles.html#af345221ac22302e8b33e60c122955c9c">mt</a>, a.<a class="code" href="classambient_1_1numeric_1_1tiles.html#af345221ac22302e8b33e60c122955c9c">mt</a>);
<a name="l00571"></a>00571         <span class="keywordtype">int</span> nb_min = std::min(r.<a class="code" href="classambient_1_1numeric_1_1tiles.html#a0034807b433e5a3cd1e1ce8feccdd943">nt</a>, a.<a class="code" href="classambient_1_1numeric_1_1tiles.html#a0034807b433e5a3cd1e1ce8feccdd943">nt</a>);
<a name="l00572"></a>00572         
<a name="l00573"></a>00573         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j = 0; j &lt; nb_min; j++){
<a name="l00574"></a>00574             <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; mb_min; i++){
<a name="l00575"></a>00575                 r.<a class="code" href="classambient_1_1numeric_1_1tiles.html#a3354919fabbcd8b3e01700211a275d4e">tile</a>(i,j) = a.<a class="code" href="classambient_1_1numeric_1_1tiles.html#a3354919fabbcd8b3e01700211a275d4e">tile</a>(i,j);
<a name="l00576"></a>00576             }
<a name="l00577"></a>00577         }
<a name="l00578"></a>00578         <span class="keywordtype">size_t</span> margin = <a class="code" href="ambient_8hpp.html#a4c631df560c1ac2dd208c0cb9ff72a4c">AMBIENT_IB</a>;
<a name="l00579"></a>00579         <span class="keywordflow">if</span>(r.<a class="code" href="classambient_1_1numeric_1_1tiles.html#af345221ac22302e8b33e60c122955c9c">mt</a> &lt;= a.<a class="code" href="classambient_1_1numeric_1_1tiles.html#af345221ac22302e8b33e60c122955c9c">mt</a>) margin = <a class="code" href="utils_2math_8hpp.html#a343eacb48f3fcb4c0cabb3efca9da618">__a_mod</a>(m, <a class="code" href="ambient_8hpp.html#a4c631df560c1ac2dd208c0cb9ff72a4c">AMBIENT_IB</a>);
<a name="l00580"></a>00580         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j = 0; j &lt; nb_min; j++){
<a name="l00581"></a>00581             Matrix&amp; <a class="code" href="classambient_1_1block.html">block</a> = r.<a class="code" href="classambient_1_1numeric_1_1tiles.html#a3354919fabbcd8b3e01700211a275d4e">tile</a>(mb_min-1,j);
<a name="l00582"></a>00582             <a class="code" href="namespaceambient_1_1numeric.html#a218e7d6acd73b129d3e26544cf8b6272">resize</a>(block, margin, block.num_cols());
<a name="l00583"></a>00583         }
<a name="l00584"></a>00584         margin = <a class="code" href="ambient_8hpp.html#a4c631df560c1ac2dd208c0cb9ff72a4c">AMBIENT_IB</a>;
<a name="l00585"></a>00585         <span class="keywordflow">if</span>(r.<a class="code" href="classambient_1_1numeric_1_1tiles.html#a0034807b433e5a3cd1e1ce8feccdd943">nt</a> &lt;= a.<a class="code" href="classambient_1_1numeric_1_1tiles.html#a0034807b433e5a3cd1e1ce8feccdd943">nt</a>) margin = <a class="code" href="utils_2math_8hpp.html#a343eacb48f3fcb4c0cabb3efca9da618">__a_mod</a>(n, <a class="code" href="ambient_8hpp.html#a4c631df560c1ac2dd208c0cb9ff72a4c">AMBIENT_IB</a>);
<a name="l00586"></a>00586         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; mb_min; i++){
<a name="l00587"></a>00587             Matrix&amp; <a class="code" href="classambient_1_1block.html">block</a> = r.<a class="code" href="classambient_1_1numeric_1_1tiles.html#a3354919fabbcd8b3e01700211a275d4e">tile</a>(i,nb_min-1);
<a name="l00588"></a>00588             <a class="code" href="namespaceambient_1_1numeric.html#a218e7d6acd73b129d3e26544cf8b6272">resize</a>(block, block.num_rows(), margin);
<a name="l00589"></a>00589         }
<a name="l00590"></a>00590         <a class="code" href="namespaceambient_1_1numeric.html#a0a238b86490882169e691146684bee91">swap</a>(a, r);
<a name="l00591"></a>00591     }
<a name="l00592"></a>00592 
<a name="l00593"></a>00593     <span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt; 
<a name="l00594"></a><a class="code" href="namespaceambient_1_1numeric.html#aff574812f9d038330b66ecefd14049d6">00594</a>     <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="namespaceambient_1_1numeric.html#a218e7d6acd73b129d3e26544cf8b6272">resize</a>(<a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles</a>&lt;<a class="code" href="classambient_1_1numeric_1_1diagonal__matrix.html">diagonal_matrix&lt;T&gt;</a> &gt;&amp; a, <span class="keywordtype">size_t</span> m, <span class="keywordtype">size_t</span> n){
<a name="l00595"></a>00595         <span class="keywordflow">if</span>(a.num_rows() == m) <span class="keywordflow">return</span>;
<a name="l00596"></a>00596         <a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles&lt;diagonal_matrix&lt;T&gt;</a> &gt; r(m, m);
<a name="l00597"></a>00597 
<a name="l00598"></a>00598         <span class="keywordtype">int</span> nb_min = std::min(r.<a class="code" href="classambient_1_1numeric_1_1tiles.html#a0034807b433e5a3cd1e1ce8feccdd943">nt</a>, a.nt);
<a name="l00599"></a>00599         
<a name="l00600"></a>00600         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; nb_min; i++){
<a name="l00601"></a>00601             r[i] = a[i];
<a name="l00602"></a>00602         }
<a name="l00603"></a>00603         <span class="keywordflow">if</span>(r.<a class="code" href="classambient_1_1numeric_1_1tiles.html#a0034807b433e5a3cd1e1ce8feccdd943">nt</a> &gt; a.nt){
<a name="l00604"></a>00604             <a class="code" href="namespaceambient_1_1numeric.html#a218e7d6acd73b129d3e26544cf8b6272">resize</a>(r[nb_min-1], <a class="code" href="ambient_8hpp.html#a4c631df560c1ac2dd208c0cb9ff72a4c">AMBIENT_IB</a>, <a class="code" href="ambient_8hpp.html#a4c631df560c1ac2dd208c0cb9ff72a4c">AMBIENT_IB</a>);
<a name="l00605"></a>00605         }<span class="keywordflow">else</span>{
<a name="l00606"></a>00606             <span class="keywordtype">size_t</span> margin = <a class="code" href="utils_2math_8hpp.html#a343eacb48f3fcb4c0cabb3efca9da618">__a_mod</a>(m, <a class="code" href="ambient_8hpp.html#a4c631df560c1ac2dd208c0cb9ff72a4c">AMBIENT_IB</a>);
<a name="l00607"></a>00607             <a class="code" href="namespaceambient_1_1numeric.html#a218e7d6acd73b129d3e26544cf8b6272">resize</a>(r[r.<a class="code" href="classambient_1_1numeric_1_1tiles.html#a0034807b433e5a3cd1e1ce8feccdd943">nt</a>-1], margin, margin);
<a name="l00608"></a>00608         }
<a name="l00609"></a>00609         <a class="code" href="namespaceambient_1_1numeric.html#a0a238b86490882169e691146684bee91">swap</a>(a, r);
<a name="l00610"></a>00610     }
<a name="l00611"></a>00611 
<a name="l00612"></a>00612     <span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt; 
<a name="l00613"></a><a class="code" href="namespaceambient_1_1numeric.html#a64bb0844076db12ced7087ed490ccb70">00613</a>     <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="namespaceambient_1_1numeric.html#aa250b71d304397a219f21b45b798c47e">sqrt_inplace</a>(<a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles</a>&lt;<a class="code" href="classambient_1_1numeric_1_1diagonal__matrix.html">diagonal_matrix&lt;T&gt;</a> &gt;&amp; a){
<a name="l00614"></a>00614         <span class="keywordtype">int</span> size = a.data.size();
<a name="l00615"></a>00615         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; size; i++){
<a name="l00616"></a>00616             <a class="code" href="namespaceambient_1_1numeric.html#aa250b71d304397a219f21b45b798c47e">sqrt_inplace</a>(a[i]);
<a name="l00617"></a>00617         }
<a name="l00618"></a>00618     }
<a name="l00619"></a>00619 
<a name="l00620"></a>00620     <span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt; 
<a name="l00621"></a><a class="code" href="namespaceambient_1_1numeric.html#a58ce731889a4bfc48f34ff08b1a5db16">00621</a>     <span class="keyword">inline</span> <a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles&lt;diagonal_matrix&lt;T&gt;</a> &gt; <a class="code" href="namespaceambient_1_1numeric.html#abec3227b03bf181bdfdc8ada03f5400d">sqrt</a>(<span class="keyword">const</span> <a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles</a>&lt;<a class="code" href="classambient_1_1numeric_1_1diagonal__matrix.html">diagonal_matrix&lt;T&gt;</a> &gt;&amp; a){
<a name="l00622"></a>00622         <a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles&lt;diagonal_matrix&lt;T&gt;</a> &gt; s(a); 
<a name="l00623"></a>00623         <a class="code" href="namespaceambient_1_1numeric.html#aa250b71d304397a219f21b45b798c47e">sqrt_inplace</a>(s);
<a name="l00624"></a>00624         <span class="keywordflow">return</span> s;
<a name="l00625"></a>00625     }
<a name="l00626"></a>00626 
<a name="l00627"></a>00627     <span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;
<a name="l00628"></a><a class="code" href="namespaceambient_1_1numeric.html#a77bda533daa7462926fc9ffbf04fb451">00628</a>     <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="namespaceambient_1_1numeric.html#a91dc584c7cb0b79710a61064fb831aa6">exp_inplace</a>(<a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles</a>&lt;<a class="code" href="classambient_1_1numeric_1_1diagonal__matrix.html">diagonal_matrix&lt;T&gt;</a> &gt;&amp; a, <span class="keyword">const</span> T&amp; alfa = 1.){
<a name="l00629"></a>00629         <span class="keywordtype">int</span> size = a.data.size();
<a name="l00630"></a>00630         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; size; i++){
<a name="l00631"></a>00631             <a class="code" href="namespaceambient_1_1numeric.html#a91dc584c7cb0b79710a61064fb831aa6">exp_inplace</a>(a[i], alfa);
<a name="l00632"></a>00632         }
<a name="l00633"></a>00633     }
<a name="l00634"></a>00634 
<a name="l00635"></a>00635     <span class="keyword">template</span>&lt;<span class="keyword">class</span> Matrix&gt; 
<a name="l00636"></a><a class="code" href="namespaceambient_1_1numeric.html#acad47867f3a8104bc6d9ff37bd15d6bf">00636</a>     <span class="keyword">inline</span> <a class="code" href="matrix_2matrix_8hpp.html#a1b219a1973718b5152571564b58dada7">scalar_type</a> <a class="code" href="namespaceambient_1_1numeric.html#a070fae9c34f3c804c72be76885865ac9">trace</a>(<span class="keyword">const</span> <a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles&lt;Matrix&gt;</a>&amp; a){
<a name="l00637"></a>00637         <span class="keywordtype">int</span> size = std::min(a.<a class="code" href="classambient_1_1numeric_1_1tiles.html#a0034807b433e5a3cd1e1ce8feccdd943">nt</a>, a.<a class="code" href="classambient_1_1numeric_1_1tiles.html#af345221ac22302e8b33e60c122955c9c">mt</a>);
<a name="l00638"></a>00638         <a class="code" href="matrix_2matrix_8hpp.html#a1b219a1973718b5152571564b58dada7">scalar_type</a> result(0.);
<a name="l00639"></a>00639         std::vector&lt;scalar_type&gt; parts;
<a name="l00640"></a>00640         parts.reserve(size);
<a name="l00641"></a>00641         
<a name="l00642"></a>00642         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k = 0; k &lt; size; k++) parts.push_back(<a class="code" href="namespaceambient_1_1numeric.html#a070fae9c34f3c804c72be76885865ac9">trace</a>(a.<a class="code" href="classambient_1_1numeric_1_1tiles.html#a3354919fabbcd8b3e01700211a275d4e">tile</a>(k, k)));
<a name="l00643"></a>00643         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k = 0; k &lt; size; k++) result += parts[k];
<a name="l00644"></a>00644         <span class="keywordflow">return</span> result;
<a name="l00645"></a>00645     }
<a name="l00646"></a>00646 
<a name="l00647"></a>00647     <span class="keyword">template</span> &lt;<span class="keyword">class</span> Matrix&gt;
<a name="l00648"></a><a class="code" href="namespaceambient_1_1numeric.html#ae19b835095f80670b54658fa5a01be2e">00648</a>     <span class="keyword">inline</span> <a class="code" href="matrix__algorithms_8hpp.html#a731a48e08c9b18c801b19dba5392ebd3">real_type</a> <a class="code" href="namespaceambient_1_1numeric.html#a1a2a754329506cce90a5737b01178c24">norm_square</a>(<span class="keyword">const</span> <a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles&lt;Matrix&gt;</a>&amp; a){
<a name="l00649"></a>00649         <span class="keywordtype">int</span> size = a.<a class="code" href="classambient_1_1numeric_1_1tiles.html#a0034807b433e5a3cd1e1ce8feccdd943">nt</a>*a.<a class="code" href="classambient_1_1numeric_1_1tiles.html#af345221ac22302e8b33e60c122955c9c">mt</a>;
<a name="l00650"></a>00650         <a class="code" href="matrix__algorithms_8hpp.html#a731a48e08c9b18c801b19dba5392ebd3">real_type</a> result(0.);
<a name="l00651"></a>00651         std::vector&lt;real_type&gt; parts;
<a name="l00652"></a>00652         parts.reserve(size);
<a name="l00653"></a>00653         
<a name="l00654"></a>00654         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k = 0; k &lt; size; k++) parts.push_back(<a class="code" href="namespaceambient_1_1numeric.html#a1a2a754329506cce90a5737b01178c24">norm_square</a>(a[k]));
<a name="l00655"></a>00655         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k = 0; k &lt; size; k++) result += parts[k];
<a name="l00656"></a>00656         <span class="keywordflow">return</span> result;
<a name="l00657"></a>00657     }
<a name="l00658"></a>00658 
<a name="l00659"></a>00659     <span class="keyword">template</span> &lt;<span class="keyword">class</span> Matrix&gt;
<a name="l00660"></a><a class="code" href="namespaceambient_1_1numeric.html#ab46ba1bd9d20b470b940adc76696dc0e">00660</a>     <span class="keyword">inline</span> <a class="code" href="matrix_2matrix_8hpp.html#a1b219a1973718b5152571564b58dada7">scalar_type</a> <a class="code" href="namespaceambient_1_1numeric.html#ad740ac7d4cc482dd3b85b5726ab9a52f">overlap</a>(<span class="keyword">const</span> <a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles&lt;Matrix&gt;</a>&amp; a, <span class="keyword">const</span> <a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles&lt;Matrix&gt;</a>&amp; b){
<a name="l00661"></a>00661         <span class="keywordtype">int</span> size = a.<a class="code" href="classambient_1_1numeric_1_1tiles.html#a0034807b433e5a3cd1e1ce8feccdd943">nt</a>*a.<a class="code" href="classambient_1_1numeric_1_1tiles.html#af345221ac22302e8b33e60c122955c9c">mt</a>;
<a name="l00662"></a>00662         <a class="code" href="matrix_2matrix_8hpp.html#a1b219a1973718b5152571564b58dada7">scalar_type</a> result(0.);
<a name="l00663"></a>00663         std::vector&lt;scalar_type&gt; parts;
<a name="l00664"></a>00664         parts.reserve(size);
<a name="l00665"></a>00665         
<a name="l00666"></a>00666         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k = 0; k &lt; size; k++) parts.push_back(<a class="code" href="namespaceambient_1_1numeric.html#ad740ac7d4cc482dd3b85b5726ab9a52f">overlap</a>(a[k], b[k]));
<a name="l00667"></a>00667         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k = 0; k &lt; size; k++) result += parts[k];
<a name="l00668"></a>00668         <span class="keywordflow">return</span> result;
<a name="l00669"></a>00669     }
<a name="l00670"></a>00670         
<a name="l00671"></a>00671     <span class="keyword">template</span>&lt;<span class="keyword">class</span> Matrix&gt;
<a name="l00672"></a><a class="code" href="namespaceambient_1_1numeric.html#adef517a9f39e271f66264e29217c01b3">00672</a>     <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="namespaceambient_1_1numeric.html#a0a238b86490882169e691146684bee91">swap</a>(<a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles&lt;Matrix&gt;</a>&amp; x, <a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles&lt;Matrix&gt;</a>&amp; y){ 
<a name="l00673"></a>00673         x.<a class="code" href="classambient_1_1numeric_1_1tiles.html#a1efb019ec264336f8403ffee231e64f3">swap</a>(y);                     
<a name="l00674"></a>00674     }
<a name="l00675"></a>00675 
<a name="l00676"></a>00676     <span class="keyword">template</span>&lt;<span class="keyword">class</span> Matrix&gt;
<a name="l00677"></a><a class="code" href="namespaceambient_1_1numeric.html#a0483077a0e611250b5c7afd2a8ef7157">00677</a>     <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="namespaceambient_1_1numeric.html#a39a8d2494b6c2189297d2d649fa51bc1">transpose_inplace</a>(<a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles&lt;Matrix&gt;</a>&amp; a){
<a name="l00678"></a>00678         std::vector&lt;Matrix*&gt; t;
<a name="l00679"></a>00679         t.reserve(a.<a class="code" href="classambient_1_1numeric_1_1tiles.html#af345221ac22302e8b33e60c122955c9c">mt</a>*a.<a class="code" href="classambient_1_1numeric_1_1tiles.html#a0034807b433e5a3cd1e1ce8feccdd943">nt</a>);
<a name="l00680"></a>00680         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; a.<a class="code" href="classambient_1_1numeric_1_1tiles.html#af345221ac22302e8b33e60c122955c9c">mt</a>; i++){
<a name="l00681"></a>00681             <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j = 0; j &lt; a.<a class="code" href="classambient_1_1numeric_1_1tiles.html#a0034807b433e5a3cd1e1ce8feccdd943">nt</a>; j++){
<a name="l00682"></a>00682                 Matrix&amp; <a class="code" href="classambient_1_1block.html">block</a> = a.<a class="code" href="classambient_1_1numeric_1_1tiles.html#a3354919fabbcd8b3e01700211a275d4e">tile</a>(i,j);
<a name="l00683"></a>00683                 <a class="code" href="namespaceambient_1_1numeric.html#a39a8d2494b6c2189297d2d649fa51bc1">transpose_inplace</a>(block);
<a name="l00684"></a>00684                 t.push_back(&amp;block);
<a name="l00685"></a>00685             }
<a name="l00686"></a>00686         }
<a name="l00687"></a>00687         <a class="code" href="namespaceambient_1_1numeric.html#a0a238b86490882169e691146684bee91">std::swap</a>(a.<a class="code" href="classambient_1_1numeric_1_1tiles.html#a7de1e2d16bff37382057a7b19b699701">data</a>, t);
<a name="l00688"></a>00688         <a class="code" href="namespaceambient_1_1numeric.html#a0a238b86490882169e691146684bee91">std::swap</a>(a.<a class="code" href="classambient_1_1numeric_1_1tiles.html#a9257eef3b2adff33d7a3f5c7904b56e0">rows</a>, a.<a class="code" href="classambient_1_1numeric_1_1tiles.html#a47bef350fa50322c7eaec2379a0f5f51">cols</a>);
<a name="l00689"></a>00689         <a class="code" href="namespaceambient_1_1numeric.html#a0a238b86490882169e691146684bee91">std::swap</a>(a.<a class="code" href="classambient_1_1numeric_1_1tiles.html#af345221ac22302e8b33e60c122955c9c">mt</a>,   a.<a class="code" href="classambient_1_1numeric_1_1tiles.html#a0034807b433e5a3cd1e1ce8feccdd943">nt</a>);
<a name="l00690"></a>00690     }
<a name="l00691"></a>00691 
<a name="l00692"></a>00692     <span class="keyword">template</span>&lt;<span class="keyword">class</span> Matrix&gt;
<a name="l00693"></a><a class="code" href="namespaceambient_1_1numeric.html#a66e8b5614fc69f8c1e608089f912ad2c">00693</a>     <span class="keyword">inline</span> <a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles&lt;transpose_view&lt;Matrix&gt;</a> &gt; <a class="code" href="namespaceambient_1_1numeric.html#afbbfcb2176b4782dd13e91a4cc42babe">transpose</a>(<span class="keyword">const</span> <a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles&lt;Matrix&gt;</a>&amp; a){
<a name="l00694"></a>00694         <a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles&lt;transpose_view&lt;Matrix&gt;</a> &gt; t;
<a name="l00695"></a>00695         std::vector&lt;transpose_view&lt;Matrix&gt;*&gt; data;
<a name="l00696"></a>00696         data.reserve(a.<a class="code" href="classambient_1_1numeric_1_1tiles.html#af345221ac22302e8b33e60c122955c9c">mt</a>*a.<a class="code" href="classambient_1_1numeric_1_1tiles.html#a0034807b433e5a3cd1e1ce8feccdd943">nt</a>);
<a name="l00697"></a>00697         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; a.<a class="code" href="classambient_1_1numeric_1_1tiles.html#af345221ac22302e8b33e60c122955c9c">mt</a>; i++)
<a name="l00698"></a>00698             <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j = 0; j &lt; a.<a class="code" href="classambient_1_1numeric_1_1tiles.html#a0034807b433e5a3cd1e1ce8feccdd943">nt</a>; j++)
<a name="l00699"></a>00699                 data.push_back(<span class="keyword">new</span> <a class="code" href="classambient_1_1numeric_1_1transpose__view.html">transpose_view&lt;Matrix&gt;</a>(a.<a class="code" href="classambient_1_1numeric_1_1tiles.html#a3354919fabbcd8b3e01700211a275d4e">tile</a>(i,j)));
<a name="l00700"></a>00700         <a class="code" href="namespaceambient_1_1numeric.html#a0a238b86490882169e691146684bee91">std::swap</a>(t.<a class="code" href="classambient_1_1numeric_1_1tiles.html#a7de1e2d16bff37382057a7b19b699701">data</a>, data);
<a name="l00701"></a>00701         t.<a class="code" href="classambient_1_1numeric_1_1tiles.html#a47bef350fa50322c7eaec2379a0f5f51">cols</a> = a.<a class="code" href="classambient_1_1numeric_1_1tiles.html#ae3864579976ac37a791a9707f02eee4c">num_rows</a>();
<a name="l00702"></a>00702         t.<a class="code" href="classambient_1_1numeric_1_1tiles.html#a9257eef3b2adff33d7a3f5c7904b56e0">rows</a> = a.<a class="code" href="classambient_1_1numeric_1_1tiles.html#a2a69e3e6f7af130998a8c93ac8b35339">num_cols</a>();
<a name="l00703"></a>00703         t.<a class="code" href="classambient_1_1numeric_1_1tiles.html#a0034807b433e5a3cd1e1ce8feccdd943">nt</a>   = a.<a class="code" href="classambient_1_1numeric_1_1tiles.html#af345221ac22302e8b33e60c122955c9c">mt</a>;
<a name="l00704"></a>00704         t.<a class="code" href="classambient_1_1numeric_1_1tiles.html#af345221ac22302e8b33e60c122955c9c">mt</a>   = a.<a class="code" href="classambient_1_1numeric_1_1tiles.html#a0034807b433e5a3cd1e1ce8feccdd943">nt</a>;
<a name="l00705"></a>00705         <span class="keywordflow">return</span> t;
<a name="l00706"></a>00706     }
<a name="l00707"></a>00707 
<a name="l00708"></a>00708     <span class="keyword">template</span>&lt;<span class="keyword">class</span> Matrix&gt;
<a name="l00709"></a><a class="code" href="namespaceambient_1_1numeric.html#a0a683988257d396219a7fdad70bce078">00709</a>     <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="namespaceambient_1_1numeric.html#a0a683988257d396219a7fdad70bce078">adjoint_inplace</a>(<a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles&lt;Matrix&gt;</a>&amp; a){
<a name="l00710"></a>00710         <a class="code" href="namespaceambient_1_1numeric.html#a39a8d2494b6c2189297d2d649fa51bc1">transpose_inplace</a>(a);
<a name="l00711"></a>00711         <a class="code" href="namespaceambient_1_1numeric.html#a1d6e02976473f0adbd0cddaf46a1cd57">conj_inplace</a>(a);
<a name="l00712"></a>00712     }
<a name="l00713"></a>00713 
<a name="l00714"></a>00714     <span class="keyword">template</span>&lt;<span class="keyword">class</span> Matrix&gt;
<a name="l00715"></a><a class="code" href="namespaceambient_1_1numeric.html#a4f2b4f15889cf29c28de8b416ab4b29f">00715</a>     <span class="keyword">inline</span> <span class="keyword">const</span> <a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles&lt;Matrix&gt;</a> <a class="code" href="namespaceambient_1_1numeric.html#a4f2b4f15889cf29c28de8b416ab4b29f">adjoint</a>(<span class="keyword">const</span> <a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles&lt;Matrix&gt;</a>&amp; a){ <span class="comment">// change to adjoint_view&lt;Matrix&gt;</span>
<a name="l00716"></a>00716         <a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles&lt;Matrix&gt;</a> b(a); 
<a name="l00717"></a>00717         <a class="code" href="namespaceambient_1_1numeric.html#a39a8d2494b6c2189297d2d649fa51bc1">transpose_inplace</a>(b);
<a name="l00718"></a>00718         <a class="code" href="namespaceambient_1_1numeric.html#a1d6e02976473f0adbd0cddaf46a1cd57">conj_inplace</a>(b);
<a name="l00719"></a>00719         <span class="keywordflow">return</span> b;
<a name="l00720"></a>00720     }
<a name="l00721"></a>00721 
<a name="l00722"></a>00722     <span class="keyword">template</span>&lt;<span class="keyword">class</span> Matrix, <span class="keyword">class</span> G&gt;
<a name="l00723"></a><a class="code" href="namespaceambient_1_1numeric.html#ab9713cc4605db7b09923e9031bbc0b94">00723</a>     <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="namespaceambient_1_1numeric.html#ab9713cc4605db7b09923e9031bbc0b94">generate</a>(<a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles&lt;Matrix&gt;</a>&amp; a, G g){
<a name="l00724"></a>00724         <a class="code" href="namespaceambient_1_1numeric.html#ab9713cc4605db7b09923e9031bbc0b94">generate</a>(a);
<a name="l00725"></a>00725     }
<a name="l00726"></a>00726 
<a name="l00727"></a>00727     <span class="keyword">template</span>&lt;<span class="keyword">class</span> Matrix&gt;
<a name="l00728"></a><a class="code" href="namespaceambient_1_1numeric.html#a6dbb0ccf9db93ad6c99be222b308fa45">00728</a>     <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="namespaceambient_1_1numeric.html#ab9713cc4605db7b09923e9031bbc0b94">generate</a>(<a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles&lt;Matrix&gt;</a>&amp; a){
<a name="l00729"></a>00729         <span class="keywordtype">int</span> size = a.<a class="code" href="classambient_1_1numeric_1_1tiles.html#a7de1e2d16bff37382057a7b19b699701">data</a>.size();
<a name="l00730"></a>00730         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; size; i++){
<a name="l00731"></a>00731             <a class="code" href="namespaceambient_1_1numeric.html#a3a46aec84c7a4bb3c5be84636f4f6322">fill_random</a>(a[i]);
<a name="l00732"></a>00732         }
<a name="l00733"></a>00733     }
<a name="l00734"></a>00734 
<a name="l00735"></a>00735     <span class="keyword">template</span>&lt;<span class="keyword">class</span> Matrix&gt;
<a name="l00736"></a><a class="code" href="namespaceambient_1_1numeric.html#a7e77ef77c7c85e47669180b495eb60ea">00736</a>     <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="namespaceambient_1_1numeric.html#a7e77ef77c7c85e47669180b495eb60ea">generate_hermitian</a>(<a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles&lt;Matrix&gt;</a>&amp; a){
<a name="l00737"></a>00737         assert(<a class="code" href="namespaceambient_1_1numeric.html#a0fecbb64cb533f5bb0dd8e6522b2161e">num_rows</a>(a) == <a class="code" href="namespaceambient_1_1numeric.html#ab3fc6c53a7c80693b666ffb7462177ba">num_cols</a>(a));
<a name="l00738"></a>00738         <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> k = 0; k &lt; a.<a class="code" href="classambient_1_1numeric_1_1tiles.html#af345221ac22302e8b33e60c122955c9c">mt</a>; ++k) 
<a name="l00739"></a>00739             <a class="code" href="namespaceambient_1_1numeric.html#aebebdd45ea744f3a3ba6e5a38f90551b">fill_random_hermitian</a>(a.<a class="code" href="classambient_1_1numeric_1_1tiles.html#a3354919fabbcd8b3e01700211a275d4e">tile</a>(k,k));
<a name="l00740"></a>00740 
<a name="l00741"></a>00741         <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> i = 0; i &lt; a.<a class="code" href="classambient_1_1numeric_1_1tiles.html#af345221ac22302e8b33e60c122955c9c">mt</a>; ++i) 
<a name="l00742"></a>00742         <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> j = i+1; j &lt; a.<a class="code" href="classambient_1_1numeric_1_1tiles.html#a0034807b433e5a3cd1e1ce8feccdd943">nt</a>; ++j){
<a name="l00743"></a>00743             <a class="code" href="namespaceambient_1_1numeric.html#a3a46aec84c7a4bb3c5be84636f4f6322">fill_random</a>(a.<a class="code" href="classambient_1_1numeric_1_1tiles.html#a3354919fabbcd8b3e01700211a275d4e">tile</a>(i,j));
<a name="l00744"></a>00744             a.<a class="code" href="classambient_1_1numeric_1_1tiles.html#a3354919fabbcd8b3e01700211a275d4e">tile</a>(j,i) = <a class="code" href="namespaceambient_1_1numeric.html#afbbfcb2176b4782dd13e91a4cc42babe">transpose</a>(<a class="code" href="namespaceambient_1_1numeric.html#a1ac1b2cef8ad63a25ffa2d254b7110d1">conj</a>(a.<a class="code" href="classambient_1_1numeric_1_1tiles.html#a3354919fabbcd8b3e01700211a275d4e">tile</a>(i,j)));
<a name="l00745"></a>00745         }
<a name="l00746"></a>00746     }
<a name="l00747"></a>00747 
<a name="l00748"></a>00748     <span class="keyword">template</span> &lt;<span class="keyword">class</span> MatrixA, <span class="keyword">class</span> MatrixB&gt;
<a name="l00749"></a><a class="code" href="namespaceambient_1_1numeric.html#aebd6afc9f63f1d05733c02fbf8848234">00749</a>     <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="namespaceambient_1_1numeric.html#a98df59583aab93885efabbdbc713c36f">add_inplace</a>(<a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles&lt;MatrixA&gt;</a>&amp; lhs, <span class="keyword">const</span> <a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles&lt;MatrixB&gt;</a>&amp; rhs){
<a name="l00750"></a>00750         <span class="keywordtype">int</span> size = lhs.<a class="code" href="classambient_1_1numeric_1_1tiles.html#a7de1e2d16bff37382057a7b19b699701">data</a>.size();
<a name="l00751"></a>00751         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; size; i++){
<a name="l00752"></a>00752             lhs[i] += rhs[i];
<a name="l00753"></a>00753         }
<a name="l00754"></a>00754     }
<a name="l00755"></a>00755 
<a name="l00756"></a>00756     <span class="keyword">template</span> &lt;<span class="keyword">class</span> MatrixA, <span class="keyword">class</span> MatrixB&gt;
<a name="l00757"></a><a class="code" href="namespaceambient_1_1numeric.html#ad9d133397dc5c0b3ee9d854d257cdc8c">00757</a>     <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="namespaceambient_1_1numeric.html#abbd75d262072c6004e10692611284230">sub_inplace</a>(<a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles&lt;MatrixA&gt;</a>&amp; lhs, <span class="keyword">const</span> <a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles&lt;MatrixB&gt;</a>&amp; rhs){ 
<a name="l00758"></a>00758         <span class="keywordtype">int</span> size = lhs.<a class="code" href="classambient_1_1numeric_1_1tiles.html#a7de1e2d16bff37382057a7b19b699701">data</a>.size();
<a name="l00759"></a>00759         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; size; i++){
<a name="l00760"></a>00760             lhs[i] -= rhs[i];
<a name="l00761"></a>00761         }
<a name="l00762"></a>00762     }
<a name="l00763"></a>00763 
<a name="l00764"></a>00764     <span class="keyword">template</span> &lt;<span class="keyword">class</span> Matrix&gt;
<a name="l00765"></a><a class="code" href="namespaceambient_1_1numeric.html#ab7488298a73110ef59d327b53ef4f48b">00765</a>     <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="namespaceambient_1_1numeric.html#a72af6c400c25399f7e44d0402ccde6a7">mul_inplace</a>(<a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles&lt;Matrix&gt;</a>&amp; a, <span class="keyword">const</span> <a class="code" href="matrix_2matrix_8hpp.html#a1b219a1973718b5152571564b58dada7">scalar_type</a>&amp; rhs) {
<a name="l00766"></a>00766 <span class="preprocessor">        #ifdef AMBIENT_LOOSE_FUTURE</span>
<a name="l00767"></a>00767 <span class="preprocessor"></span>        <span class="keywordflow">if</span>(!rhs.valid) rhs.load();
<a name="l00768"></a>00768 <span class="preprocessor">        #endif</span>
<a name="l00769"></a>00769 <span class="preprocessor"></span>        <span class="keywordflow">if</span>((<a class="code" href="diagonal__matrix_8hpp.html#a77d3f6a01bab89b6b730110f7809ead6">value_type</a>)rhs == 1.) <span class="keywordflow">return</span>; <span class="comment">// gcc debug knob + early out</span>
<a name="l00770"></a>00770         <span class="keywordtype">int</span> size = a.<a class="code" href="classambient_1_1numeric_1_1tiles.html#a7de1e2d16bff37382057a7b19b699701">data</a>.size();
<a name="l00771"></a>00771         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; size; i++){
<a name="l00772"></a>00772             a[i] *= rhs;
<a name="l00773"></a>00773         }
<a name="l00774"></a>00774     }
<a name="l00775"></a>00775 
<a name="l00776"></a>00776     <span class="keyword">template</span> &lt;<span class="keyword">class</span> Matrix&gt;
<a name="l00777"></a><a class="code" href="namespaceambient_1_1numeric.html#a53c2a72b458b054f455a8b86130fea30">00777</a>     <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="namespaceambient_1_1numeric.html#a8bc5e4952227da69566ed9c2f5a7948d">div_inplace</a>(<a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles&lt;Matrix&gt;</a>&amp; a, <span class="keyword">const</span> <a class="code" href="matrix_2matrix_8hpp.html#a1b219a1973718b5152571564b58dada7">scalar_type</a>&amp; rhs){
<a name="l00778"></a>00778 <span class="preprocessor">        #ifdef AMBIENT_LOOSE_FUTURE</span>
<a name="l00779"></a>00779 <span class="preprocessor"></span>        <span class="keywordflow">if</span>(!rhs.valid) rhs.load();
<a name="l00780"></a>00780 <span class="preprocessor">        #endif</span>
<a name="l00781"></a>00781 <span class="preprocessor"></span>        <span class="keywordflow">if</span>((<a class="code" href="diagonal__matrix_8hpp.html#a77d3f6a01bab89b6b730110f7809ead6">value_type</a>)rhs == 1.) <span class="keywordflow">return</span>; <span class="comment">// gcc debug knob + early out</span>
<a name="l00782"></a>00782         <span class="keywordtype">int</span> size = a.<a class="code" href="classambient_1_1numeric_1_1tiles.html#a7de1e2d16bff37382057a7b19b699701">data</a>.size();
<a name="l00783"></a>00783         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; size; i++)
<a name="l00784"></a>00784             a[i] /= rhs;
<a name="l00785"></a>00785     }
<a name="l00786"></a>00786  
<a name="l00787"></a>00787     <span class="keyword">template</span> &lt;<span class="keyword">class</span> Matrix&gt;
<a name="l00788"></a><a class="code" href="namespaceambient_1_1numeric.html#a70460c0df52fc192128d775c47e5346a">00788</a>     std::ostream&amp; operator &lt;&lt; (std::ostream&amp; o, const tiles&lt;Matrix&gt;&amp; a){
<a name="l00789"></a>00789         <span class="keywordtype">int</span> size = a.<a class="code" href="classambient_1_1numeric_1_1tiles.html#a7de1e2d16bff37382057a7b19b699701">data</a>.size();
<a name="l00790"></a>00790         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; size; i++)
<a name="l00791"></a>00791             o &lt;&lt; a[i];
<a name="l00792"></a>00792         <span class="keywordflow">return</span> o;
<a name="l00793"></a>00793     }
<a name="l00794"></a>00794 
<a name="l00795"></a>00795     <span class="keyword">template</span> &lt;<span class="keyword">class</span> Matrix&gt; 
<a name="l00796"></a><a class="code" href="namespaceambient_1_1numeric.html#a0789203c1ca032499a03f3ff8804c8e0">00796</a>     <span class="keyword">inline</span> <a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles&lt;Matrix&gt;</a> <a class="code" href="namespaceambient_1_1numeric.html#a38d27d3f73dc6d20eddbac2f98d0916c">operator + </a>(<a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles&lt;Matrix&gt;</a> lhs, <span class="keyword">const</span> <a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles&lt;Matrix&gt;</a>&amp; rhs){ 
<a name="l00797"></a>00797         <span class="keywordflow">return</span> (lhs += rhs);
<a name="l00798"></a>00798     }
<a name="l00799"></a>00799 
<a name="l00800"></a>00800     <span class="keyword">template</span> &lt;<span class="keyword">class</span> Matrix&gt; 
<a name="l00801"></a><a class="code" href="namespaceambient_1_1numeric.html#a6131e2e899fdef317c2450bb60364c84">00801</a>     <span class="keyword">inline</span> <a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles&lt;Matrix&gt;</a> <a class="code" href="namespaceambient_1_1numeric.html#a6e8efbec2951ad6109705c395c1897a6">operator - </a>(<a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles&lt;Matrix&gt;</a> lhs, <span class="keyword">const</span> <a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles&lt;Matrix&gt;</a>&amp; rhs){ 
<a name="l00802"></a>00802         <span class="keywordflow">return</span> (lhs -= rhs);
<a name="l00803"></a>00803     }
<a name="l00804"></a>00804 
<a name="l00805"></a>00805     <span class="keyword">template</span> &lt;<span class="keyword">class</span> Matrix, <span class="keyword">class</span> MatrixB&gt;
<a name="l00806"></a><a class="code" href="namespaceambient_1_1numeric.html#ad63cfd241817875ecb842922d0a6a9de">00806</a>     <span class="keyword">inline</span> <a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles&lt;matrix&lt;value_type,allocator_type&gt;</a> &gt; <a class="code" href="namespaceambient_1_1numeric.html#ac70dd081d9594177c215575eae096417">operator * </a>(<span class="keyword">const</span> <a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles&lt;Matrix&gt;</a>&amp; lhs, <span class="keyword">const</span> <a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles&lt;MatrixB&gt;</a>&amp; rhs){
<a name="l00807"></a>00807         <a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles&lt;matrix&lt;value_type,allocator_type&gt;</a> &gt; ret(lhs.<a class="code" href="classambient_1_1numeric_1_1tiles.html#ae3864579976ac37a791a9707f02eee4c">num_rows</a>(), rhs.<a class="code" href="classambient_1_1numeric_1_1tiles.html#a2a69e3e6f7af130998a8c93ac8b35339">num_cols</a>());
<a name="l00808"></a>00808         <a class="code" href="namespaceambient_1_1numeric.html#a965d006c32a4faf1dda4b4305f096b4c">gemm</a>(lhs, rhs, ret);
<a name="l00809"></a>00809         <span class="keywordflow">return</span> ret; 
<a name="l00810"></a>00810     }
<a name="l00811"></a>00811 
<a name="l00812"></a>00812     <span class="keyword">template</span>&lt;<span class="keyword">class</span> Matrix, <span class="keyword">typename</span> T&gt; 
<a name="l00813"></a><a class="code" href="namespaceambient_1_1numeric.html#ad644d447eccfabb50238aa7e8b8b79b7">00813</a>     <span class="keyword">inline</span> <span class="keyword">const</span> <a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles&lt;Matrix&gt;</a> <a class="code" href="namespaceambient_1_1numeric.html#ac70dd081d9594177c215575eae096417">operator * </a>(<a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles&lt;Matrix&gt;</a> lhs, <span class="keyword">const</span> T&amp; rhs){ 
<a name="l00814"></a>00814         <span class="keywordflow">return</span> (lhs *= rhs); 
<a name="l00815"></a>00815     }
<a name="l00816"></a>00816 
<a name="l00817"></a>00817     <span class="keyword">template</span>&lt;<span class="keyword">class</span> Matrix, <span class="keyword">typename</span> T&gt; 
<a name="l00818"></a><a class="code" href="namespaceambient_1_1numeric.html#a385d40419aeecfa60ab1c4c6a4855012">00818</a>     <span class="keyword">inline</span> <span class="keyword">const</span> <a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles&lt;Matrix&gt;</a> <a class="code" href="namespaceambient_1_1numeric.html#ac70dd081d9594177c215575eae096417">operator * </a>(<span class="keyword">const</span> T&amp; lhs, <a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles&lt;Matrix&gt;</a> rhs){ 
<a name="l00819"></a>00819         <span class="keywordflow">return</span> (rhs *= lhs); 
<a name="l00820"></a>00820     }
<a name="l00821"></a>00821 
<a name="l00822"></a><a class="code" href="namespaceambient_1_1numeric.html#a431eab28856abb258c72c4c524b85e2d">00822</a>     <span class="keyword">template</span>&lt;<span class="keyword">class</span> Matrix&gt; <span class="keyword">inline</span> <a class="code" href="diagonal__matrix_8hpp.html#adead3ef83e9181db3b1d4d7d098a18c0">size_type</a> <a class="code" href="namespaceambient_1_1numeric.html#a0fecbb64cb533f5bb0dd8e6522b2161e">num_rows</a>(<span class="keyword">const</span> <a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles&lt;Matrix&gt;</a>&amp; a){ 
<a name="l00823"></a>00823         <span class="keywordflow">return</span> a.<a class="code" href="classambient_1_1numeric_1_1tiles.html#ae3864579976ac37a791a9707f02eee4c">num_rows</a>();
<a name="l00824"></a>00824     }
<a name="l00825"></a>00825 
<a name="l00826"></a><a class="code" href="namespaceambient_1_1numeric.html#a0840cbe961e39441e36185996c987744">00826</a>     <span class="keyword">template</span>&lt;<span class="keyword">class</span> Matrix&gt; <span class="keyword">inline</span> <a class="code" href="diagonal__matrix_8hpp.html#adead3ef83e9181db3b1d4d7d098a18c0">size_type</a> <a class="code" href="namespaceambient_1_1numeric.html#ab3fc6c53a7c80693b666ffb7462177ba">num_cols</a>(<span class="keyword">const</span> <a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles&lt;Matrix&gt;</a>&amp; a){
<a name="l00827"></a>00827         <span class="keywordflow">return</span> a.<a class="code" href="classambient_1_1numeric_1_1tiles.html#a2a69e3e6f7af130998a8c93ac8b35339">num_cols</a>();
<a name="l00828"></a>00828     }
<a name="l00829"></a>00829 
<a name="l00830"></a>00830     <span class="keyword">template</span>&lt;<span class="keyword">class</span> MatrixA, <span class="keyword">class</span> MatrixB, <span class="keyword">class</span> Matrix&gt;
<a name="l00831"></a><a class="code" href="namespaceambient_1_1numeric.html#a1a376a77759c76eda99b34ab0af1c345">00831</a>     <span class="keywordtype">void</span> <a class="code" href="namespaceambient_1_1numeric.html#a1a376a77759c76eda99b34ab0af1c345">gemm_strassen</a>(<a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles&lt;MatrixA&gt;</a>&amp;&amp; a, <a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles&lt;MatrixB&gt;</a>&amp;&amp; b, <a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles&lt;Matrix&gt;</a>&amp;&amp; c){
<a name="l00832"></a>00832         <span class="keywordtype">size_t</span> n  = c.cols/2;
<a name="l00833"></a>00833         <span class="keywordtype">size_t</span> nt = c.nt/2;
<a name="l00834"></a>00834         <span class="keywordflow">if</span>(nt){
<a name="l00835"></a>00835             <a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles&lt;matrix&lt;value_type,allocator_type&gt;</a> &gt; m1(n, n);
<a name="l00836"></a>00836             <a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles&lt;matrix&lt;value_type,allocator_type&gt;</a> &gt; m2(n, n);
<a name="l00837"></a>00837             <a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles&lt;matrix&lt;value_type,allocator_type&gt;</a> &gt; m3(n, n);
<a name="l00838"></a>00838             <a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles&lt;matrix&lt;value_type,allocator_type&gt;</a> &gt; m4(n, n); m4 = a.<a class="code" href="classambient_1_1numeric_1_1tiles.html#a12310816a232c1b3c11941965a8d235c">subset</a>(0, 0, nt, nt);
<a name="l00839"></a>00839             <a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles&lt;matrix&lt;value_type,allocator_type&gt;</a> &gt; m5(n, n); m5 = b.<a class="code" href="classambient_1_1numeric_1_1tiles.html#a12310816a232c1b3c11941965a8d235c">subset</a>(0, 0, nt, nt);
<a name="l00840"></a>00840             <a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles&lt;matrix&lt;value_type,allocator_type&gt;</a> &gt; d(n*2, n*2); d = a;
<a name="l00841"></a>00841             <a class="code" href="classambient_1_1numeric_1_1tiles.html">tiles&lt;matrix&lt;value_type,allocator_type&gt;</a> &gt; e(n*2, n*2); e = b;
<a name="l00842"></a>00842 
<a name="l00843"></a>00843             d.<a class="code" href="classambient_1_1numeric_1_1tiles.html#a12310816a232c1b3c11941965a8d235c">subset</a>(0,  0,  nt, nt) += a.<a class="code" href="classambient_1_1numeric_1_1tiles_3_01subset__view_3_01Matrix_01_4_01_4.html#a9da0e006e12297207b87b5987e1f400f">subset</a>(0,  nt, nt, nt);  e.<a class="code" href="classambient_1_1numeric_1_1tiles.html#a12310816a232c1b3c11941965a8d235c">subset</a>(0,  0,  nt, nt) += b.<a class="code" href="classambient_1_1numeric_1_1tiles_3_01subset__view_3_01Matrix_01_4_01_4.html#a9da0e006e12297207b87b5987e1f400f">subset</a>(0,  nt, nt, nt);
<a name="l00844"></a>00844             d.<a class="code" href="classambient_1_1numeric_1_1tiles.html#a12310816a232c1b3c11941965a8d235c">subset</a>(0,  nt, nt, nt) -= a.<a class="code" href="classambient_1_1numeric_1_1tiles_3_01subset__view_3_01Matrix_01_4_01_4.html#a9da0e006e12297207b87b5987e1f400f">subset</a>(nt, nt, nt, nt);  e.<a class="code" href="classambient_1_1numeric_1_1tiles.html#a12310816a232c1b3c11941965a8d235c">subset</a>(0,  nt, nt, nt) -= b.<a class="code" href="classambient_1_1numeric_1_1tiles_3_01subset__view_3_01Matrix_01_4_01_4.html#a9da0e006e12297207b87b5987e1f400f">subset</a>(nt, nt, nt, nt);
<a name="l00845"></a>00845             d.<a class="code" href="classambient_1_1numeric_1_1tiles.html#a12310816a232c1b3c11941965a8d235c">subset</a>(nt, nt, nt, nt) += a.<a class="code" href="classambient_1_1numeric_1_1tiles_3_01subset__view_3_01Matrix_01_4_01_4.html#a9da0e006e12297207b87b5987e1f400f">subset</a>(nt, 0,  nt, nt);  e.<a class="code" href="classambient_1_1numeric_1_1tiles.html#a12310816a232c1b3c11941965a8d235c">subset</a>(nt, nt, nt, nt) += b.<a class="code" href="classambient_1_1numeric_1_1tiles_3_01subset__view_3_01Matrix_01_4_01_4.html#a9da0e006e12297207b87b5987e1f400f">subset</a>(nt, 0,  nt, nt);
<a name="l00846"></a>00846             d.<a class="code" href="classambient_1_1numeric_1_1tiles.html#a12310816a232c1b3c11941965a8d235c">subset</a>(nt, 0,  nt, nt) -= a.<a class="code" href="classambient_1_1numeric_1_1tiles_3_01subset__view_3_01Matrix_01_4_01_4.html#a9da0e006e12297207b87b5987e1f400f">subset</a>(0,  0,  nt, nt);  e.<a class="code" href="classambient_1_1numeric_1_1tiles.html#a12310816a232c1b3c11941965a8d235c">subset</a>(nt, 0,  nt, nt) -= b.<a class="code" href="classambient_1_1numeric_1_1tiles_3_01subset__view_3_01Matrix_01_4_01_4.html#a9da0e006e12297207b87b5987e1f400f">subset</a>(0,  0,  nt, nt);
<a name="l00847"></a>00847 
<a name="l00848"></a>00848             m4 += a.<a class="code" href="classambient_1_1numeric_1_1tiles.html#a12310816a232c1b3c11941965a8d235c">subset</a>(nt, nt, nt, nt);  m5 += b.<a class="code" href="classambient_1_1numeric_1_1tiles.html#a12310816a232c1b3c11941965a8d235c">subset</a>(nt, nt, nt, nt);
<a name="l00849"></a>00849            
<a name="l00850"></a>00850             <a class="code" href="namespaceambient_1_1numeric.html#a1a376a77759c76eda99b34ab0af1c345">gemm_strassen</a>(d.<a class="code" href="classambient_1_1numeric_1_1tiles.html#a12310816a232c1b3c11941965a8d235c">subset</a>(0,  nt, nt, nt),
<a name="l00851"></a>00851                           e.<a class="code" href="classambient_1_1numeric_1_1tiles.html#a12310816a232c1b3c11941965a8d235c">subset</a>(nt, nt, nt, nt),
<a name="l00852"></a>00852                           c.<a class="code" href="classambient_1_1numeric_1_1tiles_3_01subset__view_3_01Matrix_01_4_01_4.html#a9da0e006e12297207b87b5987e1f400f">subset</a>(0,  0,  nt, nt));
<a name="l00853"></a>00853             <a class="code" href="namespaceambient_1_1numeric.html#a1a376a77759c76eda99b34ab0af1c345">gemm_strassen</a>(a.subset(0,  0,  nt, nt),
<a name="l00854"></a>00854                           e.<a class="code" href="classambient_1_1numeric_1_1tiles.html#a12310816a232c1b3c11941965a8d235c">subset</a>(0,  nt, nt, nt),
<a name="l00855"></a>00855                           c.<a class="code" href="classambient_1_1numeric_1_1tiles_3_01subset__view_3_01Matrix_01_4_01_4.html#a9da0e006e12297207b87b5987e1f400f">subset</a>(0,  nt, nt, nt));
<a name="l00856"></a>00856             <a class="code" href="namespaceambient_1_1numeric.html#a1a376a77759c76eda99b34ab0af1c345">gemm_strassen</a>(d.<a class="code" href="classambient_1_1numeric_1_1tiles.html#a12310816a232c1b3c11941965a8d235c">subset</a>(nt, nt, nt, nt),
<a name="l00857"></a>00857                           b.<a class="code" href="classambient_1_1numeric_1_1tiles_3_01subset__view_3_01Matrix_01_4_01_4.html#a9da0e006e12297207b87b5987e1f400f">subset</a>(0,  0,  nt, nt),
<a name="l00858"></a>00858                           c.<a class="code" href="classambient_1_1numeric_1_1tiles_3_01subset__view_3_01Matrix_01_4_01_4.html#a9da0e006e12297207b87b5987e1f400f">subset</a>(nt, 0,  nt, nt));
<a name="l00859"></a>00859             <a class="code" href="namespaceambient_1_1numeric.html#a1a376a77759c76eda99b34ab0af1c345">gemm_strassen</a>(d.<a class="code" href="classambient_1_1numeric_1_1tiles.html#a12310816a232c1b3c11941965a8d235c">subset</a>(nt, 0,  nt, nt),
<a name="l00860"></a>00860                           e.<a class="code" href="classambient_1_1numeric_1_1tiles.html#a12310816a232c1b3c11941965a8d235c">subset</a>(0,  0,  nt, nt),
<a name="l00861"></a>00861                           c.<a class="code" href="classambient_1_1numeric_1_1tiles_3_01subset__view_3_01Matrix_01_4_01_4.html#a9da0e006e12297207b87b5987e1f400f">subset</a>(nt, nt, nt, nt));
<a name="l00862"></a>00862 
<a name="l00863"></a>00863             <a class="code" href="namespaceambient_1_1numeric.html#a1a376a77759c76eda99b34ab0af1c345">gemm_strassen</a>(std::move(m4), std::move(m5),
<a name="l00864"></a>00864                           std::move(m1));
<a name="l00865"></a>00865             <a class="code" href="namespaceambient_1_1numeric.html#a1a376a77759c76eda99b34ab0af1c345">gemm_strassen</a>(d.<a class="code" href="classambient_1_1numeric_1_1tiles.html#a12310816a232c1b3c11941965a8d235c">subset</a>(0,  0,  nt, nt),
<a name="l00866"></a>00866                           b.<a class="code" href="classambient_1_1numeric_1_1tiles_3_01subset__view_3_01Matrix_01_4_01_4.html#a9da0e006e12297207b87b5987e1f400f">subset</a>(nt, nt, nt, nt),
<a name="l00867"></a>00867                           std::move(m2));
<a name="l00868"></a>00868             <a class="code" href="namespaceambient_1_1numeric.html#a1a376a77759c76eda99b34ab0af1c345">gemm_strassen</a>(a.subset(nt, nt, nt, nt),
<a name="l00869"></a>00869                           e.<a class="code" href="classambient_1_1numeric_1_1tiles.html#a12310816a232c1b3c11941965a8d235c">subset</a>(nt, 0,  nt, nt),
<a name="l00870"></a>00870                           std::move(m3));
<a name="l00871"></a>00871 
<a name="l00872"></a>00872             c.subset(nt, nt, nt, nt) += c.subset(0,  nt, nt, nt);
<a name="l00873"></a>00873             c.subset(nt, nt, nt, nt) -= c.subset(nt, 0,  nt, nt);
<a name="l00874"></a>00874 
<a name="l00875"></a>00875             c.subset(0,  0,  nt, nt) += m1;
<a name="l00876"></a>00876             c.<a class="code" href="classambient_1_1numeric_1_1tiles.html#a12310816a232c1b3c11941965a8d235c">subset</a>(nt, nt, nt, nt) += m1;
<a name="l00877"></a>00877             c.<a class="code" href="classambient_1_1numeric_1_1tiles.html#a12310816a232c1b3c11941965a8d235c">subset</a>(0,  nt, nt, nt) += m2;
<a name="l00878"></a>00878             c.<a class="code" href="classambient_1_1numeric_1_1tiles.html#a12310816a232c1b3c11941965a8d235c">subset</a>(0,  0,  nt, nt) -= m2;
<a name="l00879"></a>00879             c.<a class="code" href="classambient_1_1numeric_1_1tiles.html#a12310816a232c1b3c11941965a8d235c">subset</a>(0,  0,  nt, nt) += m3;
<a name="l00880"></a>00880             c.<a class="code" href="classambient_1_1numeric_1_1tiles.html#a12310816a232c1b3c11941965a8d235c">subset</a>(nt, 0,  nt, nt) += m3;
<a name="l00881"></a>00881         }<span class="keywordflow">else</span>{
<a name="l00882"></a>00882             <a class="code" href="namespaceambient_1_1numeric.html#a965d006c32a4faf1dda4b4305f096b4c">gemm</a>(a[0], b[0], c[0]);
<a name="l00883"></a>00883         }
<a name="l00884"></a>00884     }
<a name="l00885"></a>00885 
<a name="l00886"></a>00886 } }
<a name="l00887"></a>00887 
<a name="l00888"></a>00888 <span class="preprocessor">#undef value_type</span>
<a name="l00889"></a>00889 <span class="preprocessor"></span><span class="preprocessor">#undef size_type</span>
<a name="l00890"></a>00890 <span class="preprocessor"></span><span class="preprocessor">#undef real_type</span>
<a name="l00891"></a>00891 <span class="preprocessor"></span><span class="preprocessor">#undef scalar_type</span>
<a name="l00892"></a>00892 <span class="preprocessor"></span><span class="preprocessor">#undef allocator_type </span>
<a name="l00893"></a>00893 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
</pre></div></div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&nbsp;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&nbsp;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&nbsp;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&nbsp;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&nbsp;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&nbsp;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&nbsp;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&nbsp;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&nbsp;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&nbsp;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&nbsp;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr size="1"/><address style="text-align: right;"><small>Generated on 26 May 2014 by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
